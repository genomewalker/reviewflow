/**
 * Rebuttr - Academic Editorial Design System
 * Scholarly meets Editorial Brutalism
 * Sharp, intellectual, with deliberate typography and dramatic contrast
 */

/* =====================================================
   FONTS - Distinctive Academic Typography
   ===================================================== */
@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&display=swap');

/* =====================================================
   CSS VARIABLES - Academic Ink & Paper
   ===================================================== */
:root {
    /* Paper backgrounds - warm ivory tones */
    --paper: #fdfcf9;
    --paper-warm: #f8f6f1;
    --paper-aged: #f3efe6;
    --paper-dark: #eae5d9;

    /* Ink colors - rich and authoritative */
    --ink: #1a1a1a;
    --ink-secondary: #3d3d3d;
    --ink-muted: #666666;
    --ink-light: #999999;
    --ink-faint: #cccccc;

    /* Accent - Editorial vermillion */
    --vermillion: #c41e3a;
    --vermillion-dark: #9a1830;
    --vermillion-light: #fef2f4;
    --vermillion-glow: rgba(196, 30, 58, 0.08);

    /* Secondary - Scholarly blue-black */
    --scholar: #1e3a5f;
    --scholar-light: #f0f4f8;

    /* Tertiary - Archive gold */
    --archive: #8b7355;
    --archive-light: #f9f7f4;

    /* Status colors - muted, sophisticated */
    --sage: #4a6741;
    --sage-bg: #f4f7f3;
    --sage-border: #d4e0d1;

    --ochre: #a67c00;
    --ochre-bg: #fdfaf0;
    --ochre-border: #f0e4b8;

    --rust: #a63d2f;
    --rust-bg: #fdf6f5;
    --rust-border: #f0d4d0;

    --slate: #4a5568;
    --slate-bg: #f7f8fa;
    --slate-border: #e2e4e8;

    /* Amber/Warning colors */
    --amber: #d97706;
    --amber-bg: #fffbeb;
    --amber-border: #fde68a;

    /* Purple/Violet accent */
    --purple: #7c3aed;
    --purple-light: #f3e8ff;
    --purple-bg: #faf5ff;

    /* Indigo accent */
    --indigo: #6366f1;
    --indigo-light: #e0e7ff;

    /* Teal accent */
    --teal: #0d9488;
    --teal-light: #ccfbf1;

    /* Emerald accent */
    --emerald: #059669;
    --emerald-light: #d1fae5;

    /* Cyan accent */
    --cyan: #0891b2;
    --cyan-light: #cffafe;

    /* Red/danger accent */
    --red: #dc2626;
    --red-light: #fef2f2;

    /* Status darker variants */
    --ochre-dark: #8a6600;
    --sage-dark: #3d5636;
    --purple-dark: #6d28d9;

    /* Terminal/Code colors */
    --terminal-bg: #0d1117;
    --terminal-text: #c9d1d9;
    --terminal-muted: #8b949e;
    --terminal-border: #30363d;

    /* Borders */
    --rule: #d4d0c8;
    --rule-light: #e8e4dc;
    --rule-dark: #b8b4ac;
    --rule-heavy: #1a1a1a;

    /* Shadows - subtle, print-like */
    --shadow-subtle: 0 1px 2px rgba(0,0,0,0.04);
    --shadow-card: 0 2px 8px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
    --shadow-elevated: 0 8px 24px rgba(0,0,0,0.08), 0 2px 8px rgba(0,0,0,0.04);
    --shadow-dramatic: 0 24px 48px rgba(0,0,0,0.12), 0 8px 16px rgba(0,0,0,0.06);

    /* Spacing - based on 4px grid */
    --sp-0: 2px;
    --sp-1: 4px;
    --sp-2: 8px;
    --sp-3: 12px;
    --sp-4: 16px;
    --sp-5: 20px;
    --sp-6: 24px;
    --sp-8: 32px;
    --sp-10: 40px;
    --sp-12: 48px;
    --sp-16: 64px;

    /* Typography scale */
    --text-2xs: 10px;
    --text-xs: 11px;
    --text-sm: 13px;
    --text-base: 15px;
    --text-lg: 17px;
    --text-xl: 20px;
    --text-2xl: 24px;
    --text-3xl: 30px;
    --text-4xl: 36px;
    --text-5xl: 48px;

    /* Typography fonts - unified to IBM Plex Sans */
    --font-display: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    --font-body: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    --font-mono: 'IBM Plex Mono', 'Menlo', 'Monaco', monospace;

    /* Border radius */
    --radius-xs: 2px;
    --radius-sm: 4px;
    --radius-md: 6px;
    --radius-lg: 8px;
    --radius-xl: 12px;
    --radius-2xl: 16px;
    --radius-full: 9999px;

    /* Transitions */
    --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    --transition-fast: 0.15s var(--ease-out);
    --transition-smooth: 0.3s var(--ease-out);

    /* Additional shadows */
    --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
}

/* =====================================================
   RESET & BASE
   ===================================================== */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    scroll-behavior: smooth;
}

body {
    font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    background: var(--paper);
    color: var(--ink);
    line-height: 1.6;
    min-height: 100vh;
    font-size: var(--text-base);
}

/* Subtle grain texture */
body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
    opacity: 0.018;
    pointer-events: none;
    z-index: 10000;
}

/* =====================================================
   TYPOGRAPHY - Academic Hierarchy
   ===================================================== */
h1, h2, h3, h4, h5, h6 {
    font-family: 'IBM Plex Sans', -apple-system, BlinkMacSystemFont, sans-serif;
    font-weight: 600;
    color: var(--ink);
    letter-spacing: -0.02em;
    line-height: 1.2;
}

h1 {
    font-size: var(--text-4xl);
    font-weight: 700;
    letter-spacing: -0.03em;
}

h2 {
    font-size: var(--text-2xl);
    font-weight: 600;
}

h3 {
    font-size: var(--text-xl);
    font-weight: 600;
}

h4 {
    font-size: var(--text-lg);
    font-weight: 500;
}

p {
    margin-bottom: 1em;
}

p:last-child {
    margin-bottom: 0;
}

code, pre, .mono {
    font-family: 'IBM Plex Mono', 'SF Mono', Consolas, monospace;
}

a {
    color: var(--vermillion);
    text-decoration: none;
    transition: color var(--transition-fast);
}

a:hover {
    color: var(--vermillion-dark);
}

::selection {
    background: var(--vermillion);
    color: white;
}

/* Small caps utility */
.small-caps {
    font-variant: small-caps;
    letter-spacing: 0.05em;
}

/* =====================================================
   LAYOUT - App Structure
   ===================================================== */
.app-container {
    display: flex;
    min-height: 100vh;
}

/* =====================================================
   SIDEBAR - Navigation Column
   ===================================================== */
.sidebar {
    width: 260px;
    min-width: 260px;
    background: var(--paper);
    border-right: 1px solid var(--rule);
    display: flex;
    flex-direction: column;
    height: 100vh;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
    overflow-y: auto;
}

.sidebar-header {
    padding: var(--sp-5);
    border-bottom: 2px solid var(--ink);
}

.back-link {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-xs);
    color: var(--ink-muted);
    letter-spacing: 0.02em;
    font-weight: 500;
    margin-bottom: var(--sp-4);
    transition: color var(--transition-fast);
}

.back-link:hover {
    color: var(--vermillion);
}

.logo {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.logo-icon {
    width: 36px;
    height: 36px;
    background: var(--ink);
    color: var(--paper);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
}

.logo-text {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-xl);
    font-weight: 700;
    letter-spacing: -0.02em;
}

.sidebar-section {
    padding: var(--sp-4) var(--sp-5);
    border-bottom: 1px solid var(--rule-light);
}

.section-title {
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: var(--text-xs);
    font-weight: 600;
    letter-spacing: 0.02em;
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

/* =====================================================
   NAVIGATION
   ===================================================== */
.nav-list {
    list-style: none;
}

.nav-item {
    margin-bottom: var(--sp-1);
}

.nav-btn {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    width: 100%;
    padding: var(--sp-2) var(--sp-3);
    background: transparent;
    border: none;
    border-radius: 0;
    font-family: inherit;
    font-size: var(--text-sm);
    font-weight: 400;
    color: var(--ink-secondary);
    cursor: pointer;
    transition: all var(--transition-fast);
    text-align: left;
    border-left: 2px solid transparent;
}

.nav-btn:hover {
    background: var(--paper-warm);
    color: var(--ink);
}

.nav-btn.active {
    background: var(--vermillion-light);
    color: var(--vermillion);
    border-left-color: var(--vermillion);
    font-weight: 500;
}

.nav-btn i {
    width: 18px;
    font-size: 14px;
    opacity: 0.7;
}

.nav-btn.active i {
    opacity: 1;
}

/* Status dot */
.status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

/* =====================================================
   MAIN CONTENT
   ===================================================== */
.main-content {
    flex: 1;
    min-width: 0;
    background: var(--paper-warm);
    display: flex;
    flex-direction: column;
    height: 100vh;
    overflow: hidden;
}

.main-header {
    padding: var(--sp-5) var(--sp-8);
    background: var(--paper);
    border-bottom: 1px solid var(--rule);
    flex-shrink: 0;
    margin-left: 260px; /* Account for fixed sidebar */
}

.content-area {
    flex: 1;
    padding: var(--sp-8);
    overflow-y: auto;
    margin-left: 260px; /* Account for fixed sidebar */
}

/* =====================================================
   CARDS - Paper-like containers
   ===================================================== */
.card {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-5);
    transition: all var(--transition-smooth);
}

.card-elevated {
    box-shadow: var(--shadow-card);
}

.card-header {
    padding-bottom: var(--sp-4);
    margin-bottom: var(--sp-4);
    border-bottom: 1px solid var(--rule-light);
}

.card-title {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--ink);
}

/* =====================================================
   COMMENT CARDS - The main content blocks
   ===================================================== */
.comment-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-4);
    transition: all var(--transition-smooth);
    position: relative;
}

.comment-card:hover {
    box-shadow: var(--shadow-elevated);
    transform: translateY(-2px);
}

.comment-card::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background: var(--rule);
    transition: background var(--transition-fast);
}

.comment-card.priority-high::before { background: var(--rust); }
.comment-card.priority-medium::before { background: var(--ochre); }
.comment-card.priority-low::before { background: var(--sage); }

.comment-header {
    padding: var(--sp-4) var(--sp-5);
    border-bottom: 1px solid var(--rule-light);
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: var(--sp-4);
}

.comment-id {
    font-family: 'IBM Plex Mono', monospace;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--paper);
    background: var(--ink);
    padding: var(--sp-1) var(--sp-2);
    display: inline-block;
    text-decoration: none;
    transition: all var(--transition-fast);
}

/* Pill-style clickable comment IDs */
a.comment-id,
.comment-link-pill {
    cursor: pointer;
    border: none;
}

a.comment-id:hover,
.comment-link-pill:hover {
    background: var(--scholar);
    color: var(--paper);
    transform: scale(1.05);
    box-shadow: 0 2px 8px rgba(30, 58, 95, 0.25);
}

.comment-body {
    padding: var(--sp-5);
}

.comment-text {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-base);
    line-height: 1.7;
    color: var(--ink-secondary);
}

.comment-text em,
.comment-text .highlight {
    background: linear-gradient(180deg, transparent 60%, var(--ochre-bg) 60%);
    font-style: normal;
}

.comment-footer {
    padding: var(--sp-3) var(--sp-5);
    background: var(--paper-warm);
    border-top: 1px solid var(--rule-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

/* Comment card header with badges */
.comment-card-header {
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    border-bottom: 1px solid var(--rule-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.comment-badges {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

/* Queue position badge */
.queue-position-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 28px;
    height: 24px;
    padding: 0 var(--sp-2);
    background: linear-gradient(135deg, var(--scholar), #6366f1);
    color: white;
    font-size: 11px;
    font-weight: 700;
    border-radius: 6px;
    font-family: 'IBM Plex Mono', monospace;
}

/* Queue order list styling */
.comments-list.queue-order .comment-card {
    border-left: 3px solid var(--scholar);
}

.comments-section-header.queue {
    color: var(--scholar);
}

/* Completed section */
.completed-section {
    margin-top: var(--sp-6);
    border: 1px solid var(--rule);
    border-radius: 8px;
    background: var(--wash);
}

.completed-section-header {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-3) var(--sp-4);
    cursor: pointer;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ink-muted);
    user-select: none;
}

.completed-section-header:hover {
    background: var(--paper);
}

.completed-section-header i:first-child {
    color: var(--sage);
}

.completed-section-header .chevron {
    margin-left: auto;
    transition: transform 0.2s ease;
    font-size: 12px;
}

.completed-section[open] .completed-section-header .chevron {
    transform: rotate(180deg);
}

.completed-section .completed-list {
    padding: var(--sp-4);
    padding-top: 0;
}

.completed-section .comment-card {
    opacity: 0.7;
}

.completed-count {
    color: var(--sage);
    font-weight: 600;
}

.empty-queue {
    text-align: center;
    padding: var(--sp-8);
    color: var(--ink-muted);
    font-size: var(--text-lg);
}

.comment-actions-inline {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.comment-card-body {
    padding: var(--sp-4);
}

/* Expert summary in comment cards */
.comment-expert-summary {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    flex-wrap: wrap;
    margin-top: var(--sp-2);
}

.comment-expert-label {
    font-size: var(--text-xs);
    color: var(--purple);
    font-weight: 500;
}

.comment-expert-label i {
    margin-right: var(--sp-1);
}

.comment-expert-name {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.comment-expert-name i {
    color: var(--ink-light);
    margin-right: 2px;
}

/* Collapsible details section */
.comment-details {
    border-top: 1px solid var(--rule-light);
}

.comment-details-summary {
    padding: var(--sp-2) var(--sp-4);
    background: var(--paper-warm);
    cursor: pointer;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink-secondary);
    transition: background var(--transition-fast);
}

.comment-details-summary:hover {
    background: var(--paper-dark);
}

.comment-details-summary i {
    margin-right: var(--sp-2);
    font-size: var(--text-2xs);
    transition: transform var(--transition-fast);
}

.comment-details[open] .comment-details-summary i {
    transform: rotate(180deg);
}

.comment-details-content {
    padding: var(--sp-4);
    background: var(--paper);
}

/* Full comment box */
.full-comment-box {
    margin-bottom: var(--sp-4);
    padding: var(--sp-4);
    background: var(--paper-warm);
    border-left: 4px solid var(--ink-light);
}

.full-comment-label {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--ink-muted);
    margin-bottom: var(--sp-2);
}

.full-comment-label i {
    margin-right: 4px;
}

.full-comment-text {
    font-size: var(--text-sm);
    color: var(--ink);
    white-space: pre-wrap;
    line-height: 1.6;
}

/* Context box */
.context-box {
    margin-bottom: var(--sp-3);
    padding: var(--sp-3);
    background: var(--purple-bg);
    border: 1px solid var(--purple-light);
}

.context-label {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--purple);
    margin-bottom: var(--sp-1);
}

.context-label i {
    margin-right: 4px;
}

.context-text {
    font-size: var(--text-xs);
    color: var(--purple-dark);
}

/* Draft response box */
.draft-response-box {
    margin-bottom: var(--sp-3);
    padding: var(--sp-4);
    background: var(--sage-bg);
    border: 1px solid var(--sage-border);
}

.draft-response-label {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--sage);
    margin-bottom: var(--sp-2);
}

.draft-response-label i {
    margin-right: 4px;
}

.draft-response-text {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    white-space: pre-wrap;
}

/* Comment card footer */
.comment-card-footer {
    padding: var(--sp-2) var(--sp-4);
    background: var(--paper-warm);
    border-top: 1px solid var(--rule-light);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--sp-2);
}

.comment-quick-actions {
    display: flex;
    align-items: center;
    gap: var(--sp-1);
}

.comment-main-actions {
    display: flex;
    align-items: center;
    gap: var(--sp-1);
}

/* =====================================================
   EXPERT PANELS - Margin notes style
   ===================================================== */
.expert-panel {
    background: var(--paper);
    border: 1px solid var(--rule);
    margin: var(--sp-4) 0;
    position: relative;
}

.expert-panel::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 3px;
}

.expert-panel.expert-dna::before { background: var(--indigo); }
.expert-panel.expert-geo::before { background: var(--cyan); }
.expert-panel.expert-contamination::before { background: var(--red); }
.expert-panel.expert-methods::before { background: var(--emerald); }
.expert-panel.expert-stats::before { background: var(--purple); }
.expert-panel.expert-default::before { background: var(--slate); }

.expert-header {
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    border-bottom: 1px solid var(--rule-light);
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.expert-icon {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: white;
}

.expert-panel.expert-dna .expert-icon { background: var(--indigo); }
.expert-panel.expert-geo .expert-icon { background: var(--cyan); }
.expert-panel.expert-contamination .expert-icon { background: var(--red); }
.expert-panel.expert-methods .expert-icon { background: var(--emerald); }
.expert-panel.expert-stats .expert-icon { background: var(--purple); }
.expert-panel.expert-default .expert-icon { background: var(--slate); }

.expert-name {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ink);
}

.expert-verdict {
    margin-left: auto;
    font-size: var(--text-xs);
    font-weight: 500;
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-xs);
}

.verdict-agree {
    background: var(--sage-bg);
    color: var(--sage);
}

.verdict-partial {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.verdict-disagree {
    background: var(--rust-bg);
    color: var(--rust);
}

.expert-body {
    padding: var(--sp-4);
}

.expert-section {
    margin-bottom: var(--sp-4);
}

.expert-section:last-child {
    margin-bottom: 0;
}

.expert-section-title {
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ink-muted);
    margin-bottom: var(--sp-2);
}

.data-point {
    display: flex;
    align-items: baseline;
    gap: var(--sp-2);
    padding: var(--sp-1) 0;
    font-size: var(--text-sm);
}

.data-point::before {
    content: 'â€¢';
    color: var(--ink-light);
}

.data-value {
    font-family: 'IBM Plex Mono', monospace;
    font-weight: 500;
    color: var(--ink);
}

/* =====================================================
   BADGES & TAGS
   ===================================================== */
.badge {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    padding: var(--sp-0) var(--sp-2);
    font-size: var(--text-xs);
    font-weight: 500;
    border-radius: var(--radius-xs);
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.badge-major {
    background: var(--vermillion);
    color: white;
}

.badge-minor {
    background: var(--ink-light);
    color: white;
}

.badge-high {
    background: var(--rust-bg);
    color: var(--rust);
    border: 1px solid var(--rust-border);
}

.badge-medium {
    background: var(--ochre-bg);
    color: var(--ochre);
    border: 1px solid var(--ochre-border);
}

.badge-low {
    background: var(--sage-bg);
    color: var(--sage);
    border: 1px solid var(--sage-border);
}

.badge-completed {
    background: var(--sage-bg);
    color: var(--sage);
}

.badge-pending {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.badge-inprogress {
    background: var(--scholar-light);
    color: var(--scholar);
}

.badge-danger {
    background: var(--rust-bg);
    color: var(--rust);
    border: 1px solid var(--rust-border);
}

.badge-warning {
    background: var(--ochre-bg);
    color: var(--ochre);
    border: 1px solid var(--ochre-border);
}

.badge-success {
    background: var(--sage-bg);
    color: var(--sage);
    border: 1px solid var(--sage-border);
}

.badge-secondary {
    background: var(--paper-dark);
    color: var(--ink-secondary);
}

.badge-purple {
    background: var(--purple-light);
    color: var(--purple);
}

.badge-info {
    background: var(--scholar-light);
    color: var(--scholar);
}

.tag {
    display: inline-block;
    padding: var(--sp-0) var(--sp-2);
    font-size: var(--text-xs);
    font-weight: 400;
    background: var(--paper-dark);
    color: var(--ink-muted);
    border-radius: var(--radius-xs);
}

/* Tag Input & Pills - for manual tag editing */
.tag-input-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
    padding: 0.5rem;
    border: 1px solid var(--rule);
    border-radius: var(--radius-sm);
    min-height: 2.5rem;
    background: var(--paper);
    align-items: center;
    transition: border-color 0.15s ease;
}

.tag-input-container:focus-within {
    border-color: var(--vermillion);
}

.tag-pill {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.2rem 0.5rem;
    background: var(--ink);
    color: var(--paper);
    border-radius: var(--radius-xs);
    font-size: var(--text-xs);
    font-weight: 500;
    font-family: var(--font-mono);
}

.tag-pill button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
    line-height: 1;
    color: var(--paper);
    font-size: 0.875rem;
    opacity: 0.7;
    transition: opacity 0.15s ease;
    margin-left: 0.125rem;
}

.tag-pill button:hover {
    opacity: 1;
}

.tag-input {
    flex: 1;
    min-width: 100px;
    border: none;
    background: transparent;
    padding: 0.25rem;
    font-size: var(--text-sm);
    outline: none;
}

.tag-input::placeholder {
    color: var(--ink-light);
}

/* Tag badge for comment cards */
.tag-badge {
    display: inline-block;
    padding: 0.125rem 0.375rem;
    font-size: var(--text-xs);
    font-weight: 500;
    background: var(--slate-bg);
    color: var(--slate);
    border-radius: var(--radius-xs);
    margin-left: 0.25rem;
    font-family: var(--font-mono);
}

/* Tag filter section */
.tag-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    align-items: center;
    margin-top: 0.5rem;
    padding-top: 0.5rem;
    border-top: 1px solid var(--rule-light);
}

.tag-filters .filter-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-weight: 500;
    letter-spacing: 0.01em;
}

.filter-btn.tag {
    background: var(--paper);
    color: var(--ink-secondary);
    border: 1px solid var(--rule);
    font-size: var(--text-xs);
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-xs);
    font-family: var(--font-mono);
    transition: all 0.15s ease;
}

.filter-btn.tag:hover {
    background: var(--ink);
    color: var(--paper);
    border-color: var(--ink);
}

.filter-btn.tag.active {
    background: var(--vermillion);
    color: white;
    border-color: var(--vermillion);
}

/* Dimension-specific tag filter styles */
.filter-label.domain { color: var(--vermillion); }
.filter-label.topic { color: var(--sage); }
.filter-label.action { color: var(--ochre); }

.filter-btn.tag.domain {
    border-color: var(--vermillion-light);
}
.filter-btn.tag.domain:hover,
.filter-btn.tag.domain.active {
    background: var(--vermillion);
    color: white;
    border-color: var(--vermillion);
}

.filter-btn.tag.topic {
    border-color: var(--sage-border);
}
.filter-btn.tag.topic:hover,
.filter-btn.tag.topic.active {
    background: var(--sage);
    color: white;
    border-color: var(--sage);
}

.filter-btn.tag.action {
    border-color: var(--ochre-border);
}
.filter-btn.tag.action:hover,
.filter-btn.tag.action.active {
    background: var(--ochre);
    color: white;
    border-color: var(--ochre);
}

.filter-count {
    opacity: 0.7;
    font-size: 0.7em;
}

/* =====================================================
   TAG ADMIN PANEL & VIEW
   ===================================================== */

/* Slide-out Panel - Academic Style */
.slide-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: 400px;
    height: 100vh;
    background: var(--paper);
    box-shadow: -2px 0 12px rgba(0, 0, 0, 0.1);
    z-index: 60;
    display: flex;
    flex-direction: column;
    transform: translateX(0);
    transition: transform 0.25s ease;
    border-left: 1px solid var(--rule);
}

.slide-panel.hidden {
    transform: translateX(100%);
}

.slide-panel-overlay {
    position: fixed;
    inset: 0;
    background: rgba(26, 26, 26, 0.4);
    z-index: 59;
}

.slide-panel-overlay.hidden {
    display: none;
}

.slide-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-4) var(--sp-5);
    border-bottom: 1px solid var(--rule);
    background: var(--paper-warm);
}

.slide-panel-header h3 {
    font-size: var(--text-base);
    font-weight: 600;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    margin: 0;
}

.slide-panel-header h3 i {
    color: var(--vermillion);
}

.slide-panel-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--sp-5);
}

/* Tag Admin Stats */
.tag-admin-stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--sp-3);
    margin-bottom: var(--sp-5);
}

.tag-stat-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-sm);
    padding: var(--sp-3);
    text-align: center;
}

.tag-stat-value {
    display: block;
    font-size: 1.375rem;
    font-weight: 700;
    color: var(--ink);
    font-family: var(--font-mono);
}

.tag-stat-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    margin-top: var(--sp-1);
}

/* Tag Admin Sections */
.tag-admin-section {
    margin-bottom: var(--sp-5);
}

.tag-admin-section h4 {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

/* Tag Admin List */
.tag-admin-list {
    max-height: 280px;
    overflow-y: auto;
    border: 1px solid var(--rule);
    border-radius: var(--radius-sm);
    background: var(--paper);
}

.tag-admin-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-3);
    border-bottom: 1px solid var(--rule-light);
}

.tag-admin-item:last-child {
    border-bottom: none;
}

.tag-admin-item:hover {
    background: var(--paper-warm);
}

.tag-admin-item-info {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.tag-admin-count {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-family: var(--font-mono);
}

.tag-admin-item-actions {
    display: flex;
    gap: var(--sp-1);
    opacity: 0;
    transition: opacity 0.15s ease;
}

.tag-admin-item:hover .tag-admin-item-actions {
    opacity: 1;
}

/* Icon Buttons */
.btn-icon {
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: var(--radius-sm);
    cursor: pointer;
    color: var(--ink-muted);
    transition: all 0.15s ease;
}

.btn-icon:hover {
    background: var(--paper-dark);
    color: var(--ink);
}

.btn-icon-sm {
    width: 26px;
    height: 26px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: transparent;
    border: none;
    border-radius: var(--radius-xs);
    cursor: pointer;
    color: var(--ink-muted);
    font-size: 0.75rem;
    transition: all 0.15s ease;
}

.btn-icon-sm:hover {
    background: var(--paper-dark);
    color: var(--ink);
}

.btn-icon-sm.btn-danger:hover {
    background: var(--rust-bg);
    color: var(--rust);
}

/* Progress Bar */
.progress-bar-container {
    width: 100%;
    height: 8px;
    background: var(--paper-dark);
    border-radius: 4px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background: var(--purple);
    border-radius: 4px;
    transition: width 0.3s ease;
}

/* Top Tags Widget in Sidebar */
.tag-filter-btn {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: var(--sp-2);
}

.tag-pill-sm {
    font-size: var(--text-xs);
    padding: 0.125rem 0.375rem;
    background: var(--ink);
    color: var(--paper);
    border-radius: var(--radius-xs);
    font-family: var(--font-mono);
}

.tag-count-sm {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-family: var(--font-mono);
}

/* Tags View (Main Content) - Academic Editorial Style */
.tags-view-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--sp-4);
    margin-bottom: var(--sp-5);
}

.stat-card {
    display: flex;
    align-items: center;
    gap: var(--sp-4);
    padding: var(--sp-4) var(--sp-5);
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
}

.stat-card.purple {
    border-left: 3px solid var(--vermillion);
}

.stat-card.purple .stat-icon {
    background: var(--vermillion-light);
    color: var(--vermillion);
}

.stat-card.green {
    border-left: 3px solid var(--sage);
}

.stat-card.green .stat-icon {
    background: var(--sage-bg);
    color: var(--sage);
}

.stat-card.amber {
    border-left: 3px solid var(--ochre);
}

.stat-card.amber .stat-icon {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.stat-card.blue {
    border-left: 3px solid var(--scholar);
}

.stat-card.blue .stat-icon {
    background: var(--scholar-light);
    color: var(--scholar);
}

.stat-icon {
    width: 44px;
    height: 44px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-sm);
    font-size: 1.125rem;
}

.stat-info {
    display: flex;
    flex-direction: column;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--ink);
    line-height: 1;
    font-family: var(--font-mono);
}

.stat-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    margin-top: 0.25rem;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.tags-view-actions {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-5);
    padding-bottom: var(--sp-4);
    border-bottom: 1px solid var(--rule);
}

/* Tags Grid - Card Layout */
.tags-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: var(--sp-4);
}

.tags-empty {
    grid-column: 1 / -1;
    text-align: center;
    padding: var(--sp-6);
    background: var(--paper-warm);
    border: 1px dashed var(--rule);
    border-radius: var(--radius-md);
}

.tags-empty > i {
    font-size: 1.5rem;
    color: var(--ink-faint);
    margin-bottom: var(--sp-3);
    display: block;
}

.tags-empty h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
}

.tags-empty p {
    color: var(--ink-muted);
    font-size: var(--text-sm);
    max-width: 320px;
    margin: 0 auto;
}

.tags-empty .btn i {
    font-size: inherit;
    color: inherit;
    display: inline;
    margin-bottom: 0;
}

.tag-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    overflow: hidden;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.tag-card:hover {
    border-color: var(--vermillion);
    box-shadow: 0 2px 8px rgba(196, 30, 58, 0.08);
}

.tag-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    border-bottom: 1px solid var(--rule-light);
}

.tag-pill-lg {
    font-size: var(--text-sm);
    font-weight: 600;
    padding: 0.25rem 0.625rem;
    background: var(--ink);
    color: var(--paper);
    border-radius: var(--radius-xs);
    font-family: var(--font-mono);
    letter-spacing: 0.01em;
}

.tag-card-count {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--vermillion);
    font-family: var(--font-mono);
}

.tag-card-comments {
    padding: var(--sp-3) var(--sp-4);
    min-height: 90px;
}

.tag-card-comment {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-2);
    padding: var(--sp-2) 0;
    cursor: pointer;
    border-radius: var(--radius-xs);
    transition: background 0.15s ease;
}

.tag-card-comment:hover {
    background: var(--paper-warm);
    margin: 0 calc(var(--sp-2) * -1);
    padding-left: var(--sp-2);
    padding-right: var(--sp-2);
}

.comment-id-mini {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--scholar);
    background: var(--scholar-light);
    padding: 0.125rem 0.375rem;
    border-radius: var(--radius-xs);
    flex-shrink: 0;
    font-family: var(--font-mono);
}

.comment-preview {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.tag-card-more {
    font-size: var(--text-xs);
    color: var(--ink-light);
    font-style: italic;
    margin-top: var(--sp-1);
}

.tag-card-actions {
    display: flex;
    gap: var(--sp-2);
    padding: var(--sp-3) var(--sp-4);
    border-top: 1px solid var(--rule-light);
    background: var(--paper-warm);
}

.tag-card-actions .btn {
    flex: 1;
    justify-content: center;
    font-size: var(--text-xs);
}

/* Tag Dimensions View */
.tag-dimensions {
    display: flex;
    flex-direction: column;
    gap: var(--sp-5);
}

.tag-dimension-section {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
}

.tag-dimension-title {
    font-size: var(--text-sm);
    font-weight: 600;
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    text-transform: uppercase;
    letter-spacing: 0.04em;
}

.tag-dimension-title.domain {
    color: var(--vermillion);
}

.tag-dimension-title.topic {
    color: var(--sage);
}

.tag-dimension-title.action {
    color: var(--ochre);
}

.tag-dimension-title i {
    font-size: 0.875rem;
}

.tag-dimension-count {
    font-size: var(--text-xs);
    font-weight: 500;
    background: var(--paper-dark);
    padding: 0.125rem 0.5rem;
    border-radius: var(--radius-xs);
    color: var(--ink-muted);
    margin-left: auto;
}

.tag-dimension-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.tag-chip {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper-warm);
    border: 1px solid var(--rule);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all 0.15s ease;
}

.tag-chip:hover {
    border-color: var(--ink);
    background: var(--paper);
}

.tag-chip.domain:hover {
    border-color: var(--vermillion);
    background: var(--vermillion-light);
}

.tag-chip.topic:hover {
    border-color: var(--sage);
    background: var(--sage-bg);
}

.tag-chip.action:hover {
    border-color: var(--ochre);
    background: var(--ochre-bg);
}

.tag-chip-name {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink);
    font-family: var(--font-mono);
}

.tag-chip-count {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-family: var(--font-mono);
}

.text-danger {
    color: var(--rust) !important;
}

.text-danger:hover {
    background: var(--rust-bg) !important;
}

/* Bulk Tagging Progress Modal */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(26, 26, 26, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 100;
}

.modal-overlay.hidden {
    display: none;
}

.bulk-tag-modal-content {
    background: var(--paper);
    border-radius: var(--radius-lg);
    width: 480px;
    max-width: 90vw;
    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15);
    border: 1px solid var(--rule);
    overflow: hidden;
}

.bulk-tag-modal-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 1.25rem;
    background: var(--paper-warm);
    border-bottom: 1px solid var(--rule);
}

.bulk-tag-modal-header i {
    font-size: 1.25rem;
    color: var(--vermillion);
}

.bulk-tag-modal-header h3 {
    font-size: 1rem;
    font-weight: 600;
    color: var(--ink);
    margin: 0;
    font-family: var(--font-sans);
    letter-spacing: -0.01em;
}

.bulk-tag-modal-body {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.25rem;
}

/* Circular Progress Ring */
.bulk-tag-progress-ring {
    position: relative;
    width: 100px;
    height: 100px;
}

.bulk-tag-progress-ring svg {
    transform: rotate(-90deg);
    width: 100%;
    height: 100%;
}

.progress-ring-bg {
    fill: none;
    stroke: var(--paper-dark);
    stroke-width: 6;
}

.progress-ring-fill {
    fill: none;
    stroke: var(--vermillion);
    stroke-width: 6;
    stroke-linecap: round;
    stroke-dasharray: 283;
    stroke-dashoffset: 283;
    transition: stroke-dashoffset 0.3s ease;
}

.progress-ring-text {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
}

.progress-ring-text span {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--ink);
    font-family: var(--font-mono);
}

/* Progress Details */
.bulk-tag-details {
    text-align: center;
    width: 100%;
}

.bulk-tag-current {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    margin-bottom: 0.75rem;
    min-height: 1.25rem;
    font-family: var(--font-sans);
}

.bulk-tag-counts {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-family: var(--font-mono);
}

.bulk-tag-counts i {
    margin-right: 0.25rem;
    color: var(--vermillion);
}

/* Log Area - Academic Journal Style */
.bulk-tag-log {
    width: 100%;
    max-height: 180px;
    overflow-y: auto;
    background: var(--paper-warm);
    border: 1px solid var(--rule);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-family: var(--font-mono);
}

.bulk-tag-log-entry {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid var(--rule-light);
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.bulk-tag-log-entry:last-child {
    border-bottom: none;
}

.bulk-tag-log-entry:nth-child(even) {
    background: var(--paper);
}

.bulk-tag-log-entry.success .comment-id {
    color: var(--sage);
}

.bulk-tag-log-entry.error .comment-id {
    color: var(--rust);
}

.bulk-tag-log-entry .comment-id {
    font-weight: 600;
    color: var(--scholar);
    flex-shrink: 0;
    min-width: 50px;
}

.bulk-tag-log-entry .tags {
    color: var(--ink-muted);
    font-size: var(--text-xs);
}

.bulk-tag-modal-footer {
    display: flex;
    justify-content: flex-end;
    gap: 0.75rem;
    padding: 1rem 1.25rem;
    background: var(--paper-warm);
    border-top: 1px solid var(--rule);
}

/* =====================================================
   BUTTONS
   ===================================================== */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-4);
    font-family: inherit;
    font-size: var(--text-sm);
    font-weight: 500;
    border: 1px solid transparent;
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
}

.btn-primary {
    background: var(--ink);
    color: var(--paper);
    border-color: var(--ink);
}

.btn-primary:hover {
    background: var(--ink-secondary);
}

.btn-secondary {
    background: transparent;
    color: var(--ink-secondary);
    border-color: var(--rule);
}

.btn-secondary:hover {
    background: var(--paper-warm);
    border-color: var(--rule-dark);
}

.btn-danger {
    background: var(--rust);
    color: white;
    border-color: var(--rust);
}

.btn-danger:hover {
    background: var(--vermillion-dark);
}

.btn-ochre {
    background: var(--ochre);
    color: white;
    border-color: var(--ochre);
}

.btn-ochre:hover {
    background: var(--ochre-dark);
}

.btn-sage {
    background: var(--sage);
    color: white;
    border-color: var(--sage);
}

.btn-sage:hover {
    background: var(--sage-dark);
}

.btn-purple {
    background: var(--purple);
    color: white;
    border-color: var(--purple);
}

.btn-purple:hover {
    background: var(--purple-dark);
}

.btn-ghost {
    background: transparent;
    color: var(--ink-muted);
    border: none;
    padding: var(--sp-2);
}

.btn-ghost:hover {
    color: var(--ink);
    background: var(--paper-warm);
}

.btn-danger-outline {
    color: var(--rust);
    border: 1px solid var(--rust-border);
    background: var(--paper);
}

.btn-danger-outline:hover {
    background: var(--rust-bg);
    border-color: var(--rust);
}

.btn-sm {
    padding: var(--sp-1) var(--sp-3);
    font-size: var(--text-xs);
}

.btn-icon {
    width: 32px;
    height: 32px;
    padding: 0;
    background: transparent;
    border: none;
    color: var(--ink-muted);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
}

.btn-icon:hover {
    color: var(--ink);
    background: var(--paper-warm);
}

/* =====================================================
   FORMS
   ===================================================== */
.form-group {
    margin-bottom: var(--sp-4);
}

.form-label {
    display: block;
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ink-muted);
    margin-bottom: var(--sp-2);
}

.form-input,
.form-select,
.form-textarea {
    width: 100%;
    padding: var(--sp-2) var(--sp-3);
    font-family: inherit;
    font-size: var(--text-sm);
    background: var(--paper);
    border: 1px solid var(--rule);
    color: var(--ink);
    transition: all var(--transition-fast);
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--ink);
    box-shadow: 0 0 0 3px rgba(26, 26, 26, 0.06);
}

.form-textarea {
    min-height: 120px;
    resize: vertical;
    line-height: 1.6;
}

/* =====================================================
   PROGRESS BAR
   ===================================================== */
.progress-bar {
    height: 4px;
    background: var(--rule-light);
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: var(--sage);
    transition: width 0.5s var(--ease-out);
}

/* =====================================================
   MODALS
   ===================================================== */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(26, 26, 26, 0.6);
    backdrop-filter: blur(4px);
    display: flex;
    align-items: flex-start;
    justify-content: center;
    z-index: 1000;
    padding: var(--sp-8);
    padding-top: var(--sp-12);
    opacity: 1;
    overflow-y: auto;
    transition: opacity var(--transition-smooth);
}

.modal-overlay.hidden {
    display: none !important;
}

.modal {
    background: var(--paper);
    width: 100%;
    max-width: 600px;
    max-height: calc(100vh - var(--sp-16));
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow-dramatic);
    animation: modalSlideIn 0.3s var(--ease-out);
    margin-bottom: var(--sp-8);
}

/* Large modal variant for response builder */
.modal-overlay .modal[style*="max-width: 900px"] {
    max-height: none;
}

.modal-overlay .modal[style*="max-width: 900px"] .modal-body {
    max-height: calc(100vh - 200px);
    overflow-y: auto;
}

@keyframes modalSlideIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-header {
    padding: var(--sp-5);
    border-bottom: 2px solid var(--ink);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.modal-title {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-xl);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.modal-body {
    padding: var(--sp-5);
    overflow-y: auto;
    flex: 1;
}

.modal-footer {
    padding: var(--sp-4) var(--sp-5);
    border-top: 1px solid var(--rule);
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--sp-3);
    background: var(--paper-warm);
}

/* =====================================================
   SETTINGS MODAL - SESSION INFO
   ===================================================== */
.settings-divider {
    height: 1px;
    background: var(--rule);
    margin: var(--sp-5) 0 var(--sp-4);
}

.settings-section-title {
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

.session-info-row {
    display: flex;
    gap: var(--sp-6);
    margin-bottom: var(--sp-4);
}

.session-info-item {
    display: flex;
    flex-direction: column;
    gap: var(--sp-1);
}

.session-info-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-weight: 500;
}

.session-id-display {
    font-family: 'IBM Plex Mono', monospace;
    font-size: var(--text-sm);
    color: var(--ink);
    background: var(--paper-warm);
    padding: var(--sp-1) var(--sp-2);
    border: 1px solid var(--rule);
    max-width: 200px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.session-message-count {
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: var(--text-base);
    font-weight: 600;
    color: var(--scholar);
}

.session-reset-btn {
    width: 100%;
    justify-content: center;
    gap: var(--sp-2);
    color: var(--rust);
    border: 1px dashed var(--rust-border);
    background: transparent;
    transition: all 0.2s ease;
}

.session-reset-btn:hover {
    background: var(--rust-bg);
    border-style: solid;
}

/* =====================================================
   BOTTOM ACTION BAR (horizontal strip)
   ===================================================== */
.bottom-bar {
    position: fixed;
    bottom: var(--sp-4);
    right: var(--sp-4);
    z-index: 900;
    display: flex;
    align-items: center;
    gap: var(--sp-1);
    background: var(--ink);
    padding: var(--sp-1);
    border-radius: 28px;
    box-shadow: var(--shadow-dramatic);
}

.bottom-bar-btn {
    width: 44px;
    height: 44px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.15s ease;
    font-size: 16px;
    background: transparent;
    color: var(--paper);
    position: relative;
}

.bottom-bar-btn:hover {
    background: rgba(255,255,255,0.15);
}

.bottom-bar-btn:active {
    transform: scale(0.95);
}

/* Go to Top - hidden by default */
#go-to-top {
    opacity: 0;
    width: 0;
    padding: 0;
    overflow: hidden;
    transition: opacity 0.2s ease, width 0.2s ease;
}

#go-to-top.visible {
    opacity: 1;
    width: 44px;
}

/* Processing badge */
.processing-badge {
    position: absolute;
    top: 4px;
    right: 4px;
    min-width: 16px;
    height: 16px;
    background: var(--vermillion);
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
}

/* Processing Panel (popup) */
.processing-panel {
    position: fixed;
    bottom: 70px;
    right: var(--sp-4);
    width: 320px;
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: 8px;
    box-shadow: var(--shadow-dramatic);
    z-index: 901;
    overflow: hidden;
}

.processing-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-3) var(--sp-4);
    background: var(--ink);
    color: var(--paper);
    font-size: var(--text-sm);
    font-weight: 500;
}

.processing-panel-header .btn-icon {
    color: var(--paper);
    opacity: 0.7;
}

.processing-panel-header .btn-icon:hover {
    opacity: 1;
}

.processing-list {
    max-height: 300px;
    overflow-y: auto;
}

.processing-empty {
    padding: var(--sp-6);
    text-align: center;
    color: var(--ink-muted);
    font-size: var(--text-sm);
}

.processing-item {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    padding: var(--sp-3) var(--sp-4);
    border-bottom: 1px solid var(--rule);
}

.processing-item:last-child {
    border-bottom: none;
}

.processing-item-spinner {
    color: var(--scholar);
    font-size: 14px;
}

.processing-item-text {
    flex: 1;
    font-size: var(--text-sm);
    color: var(--ink);
}

.processing-item-time {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

/* =====================================================
   COLLABORATION PANEL
   ===================================================== */

/* Collaboration badge (bottom bar) */
.collab-badge {
    position: absolute;
    top: 4px;
    right: 4px;
    min-width: 16px;
    height: 16px;
    background: var(--cerulean);
    color: white;
    font-size: 10px;
    font-weight: 600;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0 4px;
}

/* Collaboration Panel (popup) */
.collab-panel {
    position: fixed;
    bottom: 70px;
    right: var(--sp-4);
    width: 340px;
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: 8px;
    box-shadow: var(--shadow-dramatic);
    z-index: 901;
    overflow: hidden;
}

.collab-panel.hidden {
    display: none;
}

.collab-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-3) var(--sp-4);
    background: var(--cerulean);
    color: var(--paper);
    font-size: var(--text-sm);
    font-weight: 500;
}

.collab-panel-header .btn-icon {
    color: var(--paper);
    opacity: 0.7;
}

.collab-panel-header .btn-icon:hover {
    opacity: 1;
}

.collab-panel-body {
    padding: var(--sp-3) var(--sp-4);
}

.collab-panel-info {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

.collab-panel-info span {
    font-weight: 600;
    color: var(--cerulean);
}

.collab-panel-list {
    max-height: 200px;
    overflow-y: auto;
    margin-bottom: var(--sp-3);
    border: 1px solid var(--rule);
    border-radius: 6px;
}

.collab-panel-item {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-3);
    border-bottom: 1px solid var(--rule);
    font-size: var(--text-xs);
}

.collab-panel-item:last-child {
    border-bottom: none;
}

.collab-item-badge {
    font-size: 9px;
    font-weight: 600;
    text-transform: uppercase;
    padding: 2px 6px;
    border-radius: 4px;
    flex-shrink: 0;
}

.collab-item-badge.major {
    background: var(--vermillion-light);
    color: var(--vermillion);
}

.collab-item-badge.minor {
    background: var(--sienna-light);
    color: var(--sienna);
}

.collab-item-text {
    flex: 1;
    color: var(--ink);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.collab-panel-item .btn-icon {
    opacity: 0.5;
    font-size: 10px;
    padding: 2px;
}

.collab-panel-item .btn-icon:hover {
    opacity: 1;
    color: var(--vermillion);
}

.collab-panel-more {
    padding: var(--sp-2) var(--sp-3);
    text-align: center;
    font-size: var(--text-xs);
    color: var(--ink-muted);
    background: var(--cream);
}

.collab-panel-empty {
    padding: var(--sp-4);
    text-align: center;
    color: var(--ink-muted);
    font-size: var(--text-sm);
}

.collab-panel-actions {
    display: flex;
    justify-content: space-between;
    gap: var(--sp-2);
}

/* =====================================================
   AI TASK PANEL
   ===================================================== */

.ai-task-panel {
    position: fixed;
    bottom: 70px;
    right: var(--sp-4);
    width: 420px;
    max-height: 500px;
    background: var(--paper);
    border: 1px solid var(--rule);
    box-shadow: var(--shadow-dramatic);
    border-radius: 12px;
    overflow: hidden;
    z-index: 902;
    display: flex;
    flex-direction: column;
}

.ai-task-panel.hidden {
    display: none;
}

.ai-task-panel.minimized {
    height: auto;
    max-height: none;
}

.ai-task-panel.minimized .ai-task-body,
.ai-task-panel.minimized .ai-task-footer {
    display: none;
}

.ai-task-header {
    padding: var(--sp-3) var(--sp-4);
    background: linear-gradient(135deg, var(--ink), #374151);
    color: var(--paper);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.ai-task-title {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-weight: 600;
    font-size: var(--text-sm);
}

.ai-task-icon {
    width: 24px;
    height: 24px;
    background: rgba(255,255,255,0.15);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
}

.ai-task-controls {
    display: flex;
    align-items: center;
    gap: var(--sp-1);
}

.ai-task-btn {
    width: 28px;
    height: 28px;
    border: none;
    background: rgba(255,255,255,0.1);
    color: var(--paper);
    border-radius: 6px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.15s ease;
}

.ai-task-btn:hover {
    background: rgba(255,255,255,0.2);
}

.ai-task-btn.stop {
    background: rgba(239, 68, 68, 0.3);
}

.ai-task-btn.stop:hover {
    background: rgba(239, 68, 68, 0.5);
}

.ai-task-btn.stop:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.ai-task-status {
    padding: var(--sp-2) var(--sp-4);
    background: var(--wash);
    border-bottom: 1px solid var(--rule);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
    color: var(--ink-muted);
}

.ai-task-status i {
    color: var(--scholar);
}

.ai-task-status.success i {
    color: var(--sage);
}

.ai-task-status.error i {
    color: var(--vermillion);
}

.ai-task-body {
    flex: 1;
    overflow-y: auto;
    padding: var(--sp-3);
    max-height: 350px;
    font-family: 'IBM Plex Mono', monospace;
    font-size: 12px;
    background: #1a1a2e;
    color: #e0e0e0;
}

.ai-task-line {
    padding: 4px 0;
    line-height: 1.5;
    display: flex;
    gap: var(--sp-2);
}

.ai-task-line.header {
    color: var(--cerulean);
    font-weight: 600;
    padding-top: 12px;
    border-top: 1px solid rgba(255,255,255,0.1);
    margin-top: 8px;
}

.ai-task-line.header:first-child {
    border-top: none;
    margin-top: 0;
    padding-top: 4px;
}

.ai-task-line.info {
    color: #a0a0a0;
}

.ai-task-line.success {
    color: var(--sage);
}

.ai-task-line.error {
    color: var(--vermillion);
}

.ai-task-line.reasoning {
    color: #c4b5fd;
    font-style: italic;
    padding-left: 16px;
    border-left: 2px solid #7c3aed;
    margin: 4px 0;
}

.ai-task-line.task {
    color: #fbbf24;
}

.ai-task-line .icon {
    flex-shrink: 0;
    width: 16px;
    text-align: center;
}

.ai-task-footer {
    padding: var(--sp-2) var(--sp-4);
    background: var(--wash);
    border-top: 1px solid var(--rule);
    font-size: var(--text-xs);
    color: var(--ink-muted);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

/* =====================================================
   CHAT WINDOW
   ===================================================== */
.chat-window {
    position: fixed;
    bottom: 70px;
    right: var(--sp-4);
    width: 380px;
    height: 500px;
    background: var(--paper);
    border: 1px solid var(--rule);
    box-shadow: var(--shadow-dramatic);
    display: flex;
    flex-direction: column;
    border-radius: 8px;
    overflow: hidden;
    z-index: 901;
}

.chat-window.hidden {
    display: none;
}

.chat-header {
    padding: var(--sp-4);
    background: var(--ink);
    color: var(--paper);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.chat-header h3 {
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--paper);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.chat-header .btn-icon {
    color: var(--paper);
    opacity: 0.7;
}

.chat-header .btn-icon:hover {
    opacity: 1;
    background: rgba(255,255,255,0.1);
}

/* Chat conversation tabs */
.chat-conversation-tabs {
    display: flex;
    gap: var(--sp-1);
    padding: var(--sp-2) var(--sp-3);
    background: var(--gray-100);
    border-bottom: 1px solid var(--gray-200);
    overflow-x: auto;
}

.chat-conversation-tabs.hidden {
    display: none;
}

.chat-tab {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    padding: var(--sp-1) var(--sp-2);
    font-size: 11px;
    font-weight: 500;
    color: var(--gray-600);
    background: var(--paper);
    border: 1px solid var(--gray-200);
    border-radius: var(--radius-sm);
    cursor: pointer;
    white-space: nowrap;
    transition: all 0.15s ease;
}

.chat-tab:hover {
    background: var(--gray-50);
    border-color: var(--gray-300);
}

.chat-tab.active {
    background: var(--ink);
    color: var(--paper);
    border-color: var(--ink);
}

.chat-tab-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 16px;
    height: 16px;
    padding: 0 4px;
    font-size: 9px;
    font-weight: 600;
    background: rgba(0,0,0,0.1);
    border-radius: 8px;
}

.chat-tab.active .chat-tab-count {
    background: rgba(255,255,255,0.2);
}

.chat-messages {
    flex: 1;
    overflow-y: auto;
    padding: var(--sp-4);
    background: var(--paper-warm);
}

.chat-message {
    margin-bottom: var(--sp-4);
    animation: fadeInUp 0.3s var(--ease-out);
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(8px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chat-message.user {
    text-align: right;
}

.chat-message.user .message-bubble {
    background: var(--ink);
    color: var(--paper);
    display: inline-block;
    padding: var(--sp-3) var(--sp-4);
    max-width: 85%;
    text-align: left;
    font-size: var(--text-sm);
}

.chat-message.assistant .message-bubble {
    background: var(--paper);
    border: 1px solid var(--rule);
    display: inline-block;
    padding: var(--sp-3) var(--sp-4);
    max-width: 85%;
    font-size: var(--text-sm);
}

/* Chat message actions (Use in Response button) */
.chat-message-actions {
    margin-top: var(--sp-2);
    padding-top: var(--sp-2);
    border-top: 1px solid var(--rule);
    display: flex;
    gap: var(--sp-2);
}

.use-in-response-btn {
    font-size: var(--text-xs);
    color: var(--scholar);
    background: transparent;
    border: 1px solid var(--scholar);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-sm);
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    transition: all 0.15s ease;
}

.use-in-response-btn:hover {
    background: var(--scholar);
    color: white;
}

.use-in-response-btn i {
    font-size: 10px;
}

/* Chat welcome message */
.chat-welcome {
    text-align: center;
    padding: var(--sp-6) var(--sp-4);
}

.chat-welcome-icon {
    width: 56px;
    height: 56px;
    margin: 0 auto var(--sp-4);
    background: linear-gradient(135deg, var(--scholar) 0%, var(--ink) 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 24px;
}

.chat-welcome h4 {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
}

.chat-welcome p {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-2);
    line-height: 1.5;
}

.chat-welcome p strong {
    color: var(--ink);
}

.chat-welcome-stats {
    font-size: var(--text-xs);
    color: var(--sage);
    font-weight: 500;
    margin-bottom: var(--sp-4);
}

.chat-welcome-tips {
    margin-top: var(--sp-4);
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
}

.chat-tip {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-xs);
    color: var(--ink-light);
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper);
    border-radius: var(--radius-md);
}

.chat-tip i {
    color: var(--ochre);
    width: 16px;
}

.chat-tip kbd {
    background: var(--paper-dark);
    padding: var(--sp-0) var(--sp-2);
    border-radius: var(--radius-xs);
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
}

.chat-input-area {
    padding: var(--sp-3);
    border-top: 1px solid var(--rule);
    display: flex;
    gap: var(--sp-2);
    align-items: flex-end;
}

.chat-input {
    flex: 1;
    resize: none;
    border: 1px solid var(--rule);
    padding: var(--sp-2) var(--sp-3);
    font-family: inherit;
    font-size: var(--text-sm);
    max-height: 100px;
    background: var(--paper);
}

.chat-input:focus {
    outline: none;
    border-color: var(--ink);
}

.chat-clear-confirm {
    display: none;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-3);
    background: var(--ochre-bg);
    border-top: 1px solid var(--ochre-border);
    font-size: var(--text-sm);
}

.chat-clear-confirm.show {
    display: flex;
}

/* .chat-fab is now .floating-btn-primary in the floating strip */

/* =====================================================
   OVERVIEW STATS
   ===================================================== */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--sp-4);
    margin-bottom: var(--sp-6);
}

.stat-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-5);
    display: flex;
    align-items: center;
    gap: var(--sp-4);
}

.stat-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.stat-icon.comments { background: var(--slate-bg); color: var(--slate); }
.stat-icon.major { background: var(--rust-bg); color: var(--rust); }
.stat-icon.high { background: var(--ochre-bg); color: var(--ochre); }
.stat-icon.completed { background: var(--sage-bg); color: var(--sage); }

.stat-value {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-3xl);
    font-weight: 700;
    color: var(--ink);
    line-height: 1;
}

.stat-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-top: var(--sp-1);
}

/* =====================================================
   REVIEWER CARDS
   ===================================================== */
.reviewer-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-5);
    cursor: pointer;
    transition: all var(--transition-smooth);
}

.reviewer-card:hover {
    box-shadow: var(--shadow-card);
    border-color: var(--rule-dark);
}

.reviewer-name {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-lg);
    font-weight: 600;
    margin-bottom: var(--sp-1);
}

.reviewer-expertise {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

.reviewer-stats {
    display: flex;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

/* =====================================================
   COLLAPSIBLE SECTIONS
   ===================================================== */
.collapsible-trigger {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    border: none;
    width: 100%;
    text-align: left;
    cursor: pointer;
    font-family: inherit;
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink-secondary);
    transition: all var(--transition-fast);
}

.collapsible-trigger:hover {
    background: var(--paper-dark);
}

.collapsible-trigger i {
    transition: transform var(--transition-fast);
}

.collapsible-trigger.open i {
    transform: rotate(90deg);
}

.collapsible-content {
    display: none;
    padding: var(--sp-4);
    background: var(--paper);
    border-top: 1px solid var(--rule-light);
}

.collapsible-content.open {
    display: block;
}

/* =====================================================
   RESPONSE SECTION
   ===================================================== */
.response-section {
    background: var(--sage-bg);
    border: 1px solid var(--sage-border);
    padding: var(--sp-4);
    margin-top: var(--sp-4);
}

.response-label {
    font-size: var(--text-xs);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--sage);
    margin-bottom: var(--sp-2);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.response-text {
    font-family: 'IBM Plex Sans', -apple-system, sans-serif;
    font-size: var(--text-sm);
    line-height: 1.7;
    color: var(--ink-secondary);
}

/* Draft response (yellow) */
.draft-response {
    background: var(--ochre-bg);
    border-color: var(--ochre-border);
}

.draft-response .response-label {
    color: var(--ochre);
}

/* =====================================================
   UTILITY CLASSES - Complete Tailwind Replacement
   ===================================================== */

/* Display */
.flex { display: flex; }
.flex-col { flex-direction: column; }
.flex-wrap { flex-wrap: wrap; }
.flex-1 { flex: 1; }
.flex-shrink-0 { flex-shrink: 0; }
.grid { display: grid; }
.hidden { display: none !important; }
.block { display: block; }
.inline { display: inline; }
.inline-block { display: inline-block; }
.inline-flex { display: inline-flex; }

/* Alignment */
.items-center { align-items: center; }
.items-start { align-items: flex-start; }
.items-end { align-items: flex-end; }
.items-baseline { align-items: baseline; }
.justify-center { justify-content: center; }
.justify-between { justify-content: space-between; }
.justify-end { justify-content: flex-end; }
.justify-start { justify-content: flex-start; }
.text-center { text-align: center; }
.text-right { text-align: right; }
.text-left { text-align: left; }

/* Gap */
.gap-0\.5 { gap: 2px; }
.gap-1 { gap: var(--sp-1); }
.gap-1\.5 { gap: 6px; }
.gap-2 { gap: var(--sp-2); }
.gap-3 { gap: var(--sp-3); }
.gap-4 { gap: var(--sp-4); }
.gap-5 { gap: var(--sp-5); }
.gap-6 { gap: var(--sp-6); }
.gap-8 { gap: var(--sp-8); }

/* Space-y utilities */
.space-y-1 > * + * { margin-top: var(--sp-1); }
.space-y-2 > * + * { margin-top: var(--sp-2); }
.space-y-3 > * + * { margin-top: var(--sp-3); }
.space-y-4 > * + * { margin-top: var(--sp-4); }
.space-y-6 > * + * { margin-top: var(--sp-6); }
.space-x-2 > * + * { margin-left: var(--sp-2); }

/* Padding */
.p-0 { padding: 0; }
.p-1 { padding: var(--sp-1); }
.p-1\.5 { padding: 6px; }
.p-2 { padding: var(--sp-2); }
.p-3 { padding: var(--sp-3); }
.p-4 { padding: var(--sp-4); }
.p-5 { padding: var(--sp-5); }
.p-6 { padding: var(--sp-6); }
.p-8 { padding: var(--sp-8); }
.px-1 { padding-left: var(--sp-1); padding-right: var(--sp-1); }
.px-1\.5 { padding-left: 6px; padding-right: 6px; }
.px-2 { padding-left: var(--sp-2); padding-right: var(--sp-2); }
.px-2\.5 { padding-left: 10px; padding-right: 10px; }
.px-3 { padding-left: var(--sp-3); padding-right: var(--sp-3); }
.px-4 { padding-left: var(--sp-4); padding-right: var(--sp-4); }
.px-6 { padding-left: var(--sp-6); padding-right: var(--sp-6); }
.py-0\.5 { padding-top: 2px; padding-bottom: 2px; }
.py-1 { padding-top: var(--sp-1); padding-bottom: var(--sp-1); }
.py-1\.5 { padding-top: 6px; padding-bottom: 6px; }
.py-2 { padding-top: var(--sp-2); padding-bottom: var(--sp-2); }
.py-3 { padding-top: var(--sp-3); padding-bottom: var(--sp-3); }
.py-4 { padding-top: var(--sp-4); padding-bottom: var(--sp-4); }
.py-8 { padding-top: var(--sp-8); padding-bottom: var(--sp-8); }
.py-12 { padding-top: var(--sp-12); padding-bottom: var(--sp-12); }
.py-20 { padding-top: 80px; padding-bottom: 80px; }
.pt-1 { padding-top: var(--sp-1); }
.pt-2 { padding-top: var(--sp-2); }
.pt-3 { padding-top: var(--sp-3); }
.pt-4 { padding-top: var(--sp-4); }
.pb-2 { padding-bottom: var(--sp-2); }
.pr-2 { padding-right: var(--sp-2); }
.pl-4 { padding-left: var(--sp-4); }

/* Margin */
.m-0 { margin: 0; }
.mx-2 { margin-left: var(--sp-2); margin-right: var(--sp-2); }
.mx-auto { margin-left: auto; margin-right: auto; }
.mt-0\.5 { margin-top: 2px; }
.mt-1 { margin-top: var(--sp-1); }
.mt-2 { margin-top: var(--sp-2); }
.mt-3 { margin-top: var(--sp-3); }
.mt-4 { margin-top: var(--sp-4); }
.mt-5 { margin-top: var(--sp-5); }
.mt-6 { margin-top: var(--sp-6); }
.mt-8 { margin-top: var(--sp-8); }
.mb-1 { margin-bottom: var(--sp-1); }
.mb-2 { margin-bottom: var(--sp-2); }
.mb-3 { margin-bottom: var(--sp-3); }
.mb-4 { margin-bottom: var(--sp-4); }
.mb-5 { margin-bottom: var(--sp-5); }
.mb-6 { margin-bottom: var(--sp-6); }
.mb-8 { margin-bottom: var(--sp-8); }
.ml-1 { margin-left: var(--sp-1); }
.ml-2 { margin-left: var(--sp-2); }
.ml-3 { margin-left: var(--sp-3); }
.ml-4 { margin-left: var(--sp-4); }
.ml-auto { margin-left: auto; }
.mr-1 { margin-right: var(--sp-1); }
.mr-1\.5 { margin-right: 6px; }
.mr-2 { margin-right: var(--sp-2); }
.mr-3 { margin-right: var(--sp-3); }

/* Width */
.w-1\.5 { width: 6px; }
.w-2 { width: 8px; }
.w-3 { width: 12px; }
.w-4 { width: 16px; }
.w-5 { width: 20px; }
.w-6 { width: 24px; }
.w-7 { width: 28px; }
.w-8 { width: 32px; }
.w-10 { width: 40px; }
.w-12 { width: 48px; }
.w-14 { width: 56px; }
.w-16 { width: 64px; }
.w-full { width: 100%; }
.w-auto { width: auto; }
.min-w-0 { min-width: 0; }

/* Height */
.h-1\.5 { height: 6px; }
.h-2 { height: 8px; }
.h-3 { height: 12px; }
.h-4 { height: 16px; }
.h-5 { height: 20px; }
.h-6 { height: 24px; }
.h-8 { height: 32px; }
.h-10 { height: 40px; }
.h-12 { height: 48px; }
.h-full { height: 100%; }

/* Max dimensions */
.max-h-40 { max-height: 160px; }
.max-h-48 { max-height: 192px; }
.max-h-60 { max-height: 240px; }
.max-h-96 { max-height: 384px; }
.max-w-md { max-width: 448px; }
.max-w-lg { max-width: 512px; }
.max-w-2xl { max-width: 672px; }
.max-w-none { max-width: none; }

/* Typography */
.text-\[8px\] { font-size: 8px; }
.text-xs { font-size: var(--text-xs); }
.text-sm { font-size: var(--text-sm); }
.text-base { font-size: var(--text-base); }
.text-lg { font-size: var(--text-lg); }
.text-xl { font-size: var(--text-xl); }
.text-2xl { font-size: var(--text-2xl); }
.text-3xl { font-size: var(--text-3xl); }
.text-4xl { font-size: var(--text-4xl); }
.font-normal { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }
.font-mono { font-family: 'IBM Plex Mono', monospace; }
.italic { font-style: italic; }
.uppercase { text-transform: uppercase; }
.leading-tight { line-height: 1.25; }
.leading-relaxed { line-height: 1.625; }
.tracking-wide { letter-spacing: 0.025em; }
.truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.whitespace-pre-line { white-space: pre-line; }
.whitespace-pre-wrap { white-space: pre-wrap; }
.line-through { text-decoration: line-through; }

/* Text Colors - Design System */
.text-primary { color: var(--ink); }
.text-secondary { color: var(--ink-secondary); }
.text-muted { color: var(--ink-muted); }
.text-light { color: var(--ink-light); }
.text-vermillion { color: var(--vermillion); }
.text-success { color: var(--sage); }
.text-warning { color: var(--ochre); }
.text-danger { color: var(--rust); }
.text-white { color: white; }

/* Text Colors - Semantic (mapped to design system) */
.text-gray-300 { color: #d1d5db; }
.text-gray-400 { color: var(--ink-light); }
.text-gray-500 { color: var(--ink-muted); }
.text-gray-600 { color: var(--ink-secondary); }
.text-gray-700 { color: var(--ink-secondary); }
.text-gray-800 { color: var(--ink); }
.text-slate-400 { color: #94a3b8; }
.text-slate-500 { color: #64748b; }
.text-slate-600 { color: #475569; }
.text-slate-700 { color: #334155; }
.text-slate-900 { color: #0f172a; }

/* Text Colors - Status colors */
.text-green-500 { color: #22c55e; }
.text-green-600 { color: var(--sage); }
.text-green-700 { color: #15803d; }
.text-green-800 { color: #166534; }
.text-emerald-500 { color: #10b981; }
.text-emerald-600 { color: #059669; }
.text-emerald-700 { color: #047857; }
.text-emerald-800 { color: #065f46; }
.text-emerald-900 { color: #064e3b; }
.text-blue-500 { color: #3b82f6; }
.text-blue-600 { color: var(--scholar); }
.text-blue-700 { color: #1d4ed8; }
.text-blue-800 { color: #1e40af; }
.text-blue-900 { color: #1e3a8a; }
.text-amber-500 { color: #f59e0b; }
.text-amber-600 { color: var(--ochre); }
.text-amber-700 { color: #b45309; }
.text-amber-800 { color: #92400e; }
.text-amber-900 { color: #78350f; }
.text-yellow-500 { color: #eab308; }
.text-yellow-600 { color: #ca8a04; }
.text-yellow-700 { color: #a16207; }
.text-orange-600 { color: #ea580c; }
.text-orange-700 { color: #c2410c; }
.text-red-500 { color: #ef4444; }
.text-red-600 { color: var(--rust); }
.text-red-700 { color: #b91c1c; }
.text-red-800 { color: #991b1b; }
.text-purple-400 { color: #c084fc; }
.text-purple-500 { color: #a855f7; }
.text-purple-600 { color: #9333ea; }
.text-purple-700 { color: #7c3aed; }
.text-purple-800 { color: #6b21a8; }
.text-purple-900 { color: #581c87; }
.text-indigo-600 { color: #4f46e5; }
.text-teal-600 { color: #0d9488; }

/* Background Colors - Design System */
.bg-paper { background: var(--paper); }
.bg-warm { background: var(--paper-warm); }
.bg-dark { background: var(--paper-dark); }
.bg-white { background: white; }
.bg-black { background: black; }
.bg-white\/50 { background: rgba(255, 255, 255, 0.5); }
.bg-transparent { background: transparent; }

/* Background Colors - Semantic */
.bg-gray-50 { background: #f9fafb; }
.bg-gray-100 { background: var(--paper-warm); }
.bg-gray-200 { background: var(--paper-dark); }
.bg-gray-800 { background: #1f2937; }
.bg-slate-50 { background: #f8fafc; }
.bg-slate-100 { background: #f1f5f9; }
.bg-green-50 { background: var(--sage-bg); }
.bg-green-100 { background: #dcfce7; }
.bg-green-200 { background: #bbf7d0; }
.bg-green-300 { background: #86efac; }
.bg-green-500 { background: #22c55e; }
.bg-green-600 { background: var(--sage); }
.bg-emerald-100 { background: #d1fae5; }
.bg-emerald-600 { background: #059669; }
.bg-blue-50 { background: var(--scholar-light); }
.bg-blue-100 { background: #dbeafe; }
.bg-blue-200 { background: #bfdbfe; }
.bg-blue-500 { background: #3b82f6; }
.bg-blue-600 { background: var(--scholar); }
.bg-amber-50 { background: var(--ochre-bg); }
.bg-amber-100 { background: #fef3c7; }
.bg-amber-200 { background: #fde68a; }
.bg-yellow-50 { background: var(--ochre-bg); }
.bg-yellow-100 { background: #fef9c3; }
.bg-yellow-500 { background: #eab308; }
.bg-orange-100 { background: #ffedd5; }
.bg-red-50 { background: var(--rust-bg); }
.bg-red-100 { background: #fee2e2; }
.bg-red-500 { background: #ef4444; }
.bg-red-600 { background: var(--rust); }
.bg-purple-50 { background: #faf5ff; }
.bg-purple-100 { background: #f3e8ff; }
.bg-purple-200 { background: #e9d5ff; }
.bg-purple-600 { background: #9333ea; }
.bg-indigo-100 { background: #e0e7ff; }
.bg-teal-600 { background: #0d9488; }

/* Gradients */
.bg-gradient-to-r { background: linear-gradient(to right, var(--tw-gradient-stops)); }
.bg-gradient-to-br { background: linear-gradient(to bottom right, var(--tw-gradient-stops)); }
.from-green-500 { --tw-gradient-from: #22c55e; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
.from-blue-500 { --tw-gradient-from: #3b82f6; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
.from-purple-500 { --tw-gradient-from: #a855f7; --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to, transparent); }
.to-blue-50 { --tw-gradient-to: #eff6ff; }
.to-gray-100 { --tw-gradient-to: #f3f4f6; }
.to-gray-600 { --tw-gradient-to: #4b5563; }
.to-gray-900 { --tw-gradient-to: #111827; }
.to-indigo-50 { --tw-gradient-to: #eef2ff; }
.to-indigo-600 { --tw-gradient-to: #4f46e5; }
.to-teal-50 { --tw-gradient-to: #f0fdfa; }
.to-teal-500 { --tw-gradient-to: #14b8a6; }
.to-teal-600 { --tw-gradient-to: #0d9488; }
.to-orange-500 { --tw-gradient-to: #f97316; }
.to-purple-600 { --tw-gradient-to: #9333ea; }

/* Opacity */
.opacity-0 { opacity: 0; }
.opacity-50 { opacity: 0.5; }
.opacity-60 { opacity: 0.6; }
.opacity-80 { opacity: 0.8; }
.opacity-90 { opacity: 0.9; }
.bg-opacity-20 { --tw-bg-opacity: 0.2; }
.bg-opacity-50 { --tw-bg-opacity: 0.5; }
.text-opacity-80 { --tw-text-opacity: 0.8; }
.text-opacity-90 { --tw-text-opacity: 0.9; }
.border-opacity-20 { --tw-border-opacity: 0.2; }
.disabled\:opacity-50:disabled { opacity: 0.5; }

/* Borders */
.border { border: 1px solid var(--rule); }
.border-2 { border-width: 2px; }
.border-t { border-top: 1px solid var(--rule); }
.border-b { border-bottom: 1px solid var(--rule); }
.border-l { border-left: 1px solid var(--rule); }
.border-l-4 { border-left-width: 4px; }
.border-r { border-right: 1px solid var(--rule); }
.border-white { border-color: white; }
.border-gray-100 { border-color: #f3f4f6; }
.border-gray-200 { border-color: var(--rule); }
.border-gray-300 { border-color: var(--rule-dark); }
.border-slate-200 { border-color: #e2e8f0; }
.border-slate-400 { border-color: #94a3b8; }
.border-green-100 { border-color: #dcfce7; }
.border-green-200 { border-color: var(--sage-border); }
.border-green-500 { border-color: #22c55e; }
.border-emerald-100 { border-color: #d1fae5; }
.border-emerald-200 { border-color: #a7f3d0; }
.border-blue-100 { border-color: #dbeafe; }
.border-blue-200 { border-color: #bfdbfe; }
.border-amber-200 { border-color: var(--ochre-border); }
.border-yellow-200 { border-color: var(--ochre-border); }
.border-red-100 { border-color: #fee2e2; }
.border-red-200 { border-color: var(--rust-border); }
.border-purple-200 { border-color: #e9d5ff; }
.border-purple-300 { border-color: #d8b4fe; }
.border-l-red-500 { border-left-color: #ef4444; }

/* Border Radius */
.rounded { border-radius: var(--radius-sm); }
.rounded-sm { border-radius: var(--radius-xs); }
.rounded-md { border-radius: var(--radius-md); }
.rounded-lg { border-radius: var(--radius-lg); }
.rounded-xl { border-radius: var(--radius-xl); }
.rounded-2xl { border-radius: var(--radius-2xl); }
.rounded-full { border-radius: var(--radius-full); }
.rounded-r { border-top-right-radius: var(--radius-sm); border-bottom-right-radius: var(--radius-sm); }

/* Shadows */
.shadow { box-shadow: var(--shadow-subtle); }
.shadow-sm { box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05); }
.shadow-card { box-shadow: var(--shadow-card); }
.shadow-lg { box-shadow: var(--shadow-elevated); }
.shadow-xl { box-shadow: var(--shadow-elevated); }
.shadow-2xl { box-shadow: var(--shadow-dramatic); }
.shadow-elevated { box-shadow: var(--shadow-elevated); }

/* Ring */
.ring-2 { box-shadow: 0 0 0 2px var(--tw-ring-color, currentColor); }
.ring-blue-400 { --tw-ring-color: #60a5fa; }
.ring-slate-900 { --tw-ring-color: #0f172a; }
.ring-offset-1 { --tw-ring-offset-width: 1px; }

/* Overflow */
.overflow-hidden { overflow: hidden; }
.overflow-auto { overflow: auto; }
.overflow-y-auto { overflow-y: auto; }

/* Position */
.relative { position: relative; }
.absolute { position: absolute; }
.fixed { position: fixed; }
.sticky { position: sticky; }
.inset-0 { inset: 0; }
.top-0 { top: 0; }
.right-0 { right: 0; }
.z-10 { z-index: 10; }
.z-50 { z-index: 50; }

/* Cursor */
.cursor-pointer { cursor: pointer; }
.cursor-move { cursor: move; }

/* Transitions */
.transition { transition: all var(--transition-smooth); }
.transition-all { transition: all 0.15s ease; }
.transition-colors { transition: color 0.15s ease, background-color 0.15s ease, border-color 0.15s ease; }
.transition-opacity { transition: opacity 0.15s ease; }
.transition-transform { transition: transform 0.15s ease; }
.duration-200 { transition-duration: 200ms; }

/* Transform */
.transform { transform: translateX(0); }
.rotate-90 { transform: rotate(90deg); }
.scale-105 { transform: scale(1.05); }

/* Grid */
.grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
.grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
.grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
.grid-cols-6 { grid-template-columns: repeat(6, 1fr); }

/* Responsive Grid */
@media (min-width: 640px) {
    .sm\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
}
@media (min-width: 768px) {
    .md\:grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
    .md\:grid-cols-3 { grid-template-columns: repeat(3, 1fr); }
    .md\:grid-cols-4 { grid-template-columns: repeat(4, 1fr); }
    .md\:grid-cols-6 { grid-template-columns: repeat(6, 1fr); }
}

/* Prose styling for markdown content */
.prose { max-width: 65ch; }
.prose p { margin-bottom: 1em; }
.prose h1, .prose h2, .prose h3, .prose h4 { margin-top: 1.5em; margin-bottom: 0.5em; }
.prose ul, .prose ol { padding-left: 1.5em; margin-bottom: 1em; }
.prose li { margin-bottom: 0.25em; }
.prose code { background: var(--paper-dark); padding: 0.125em 0.25em; border-radius: var(--radius-xs); font-size: 0.875em; }
.prose pre { background: var(--paper-dark); padding: 1em; overflow-x: auto; margin-bottom: 1em; }
.prose blockquote { border-left: 3px solid var(--rule); padding-left: 1em; color: var(--ink-muted); }
.prose-sm { font-size: var(--text-sm); }

/* Hover states */
.hover\:bg-gray-50:hover { background: #f9fafb; }
.hover\:bg-gray-100:hover { background: var(--paper-warm); }
.hover\:bg-blue-50:hover { background: var(--scholar-light); }
.hover\:shadow-lg:hover { box-shadow: var(--shadow-elevated); }
.hover\:shadow-xl:hover { box-shadow: var(--shadow-elevated); }

/* Group hover */
.group:hover .group-hover\:opacity-100 { opacity: 1; }

/* =====================================================
   SKELETON LOADING STATES
   ===================================================== */
.skeleton {
    background: linear-gradient(90deg, var(--paper-dark) 25%, var(--paper-warm) 50%, var(--paper-dark) 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s infinite;
    border-radius: var(--radius-sm);
}

@keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

.skeleton-card {
    height: 120px;
    margin-bottom: var(--sp-4);
}

.skeleton-text {
    height: 16px;
    margin-bottom: var(--sp-2);
}

.skeleton-text:last-child {
    width: 60%;
}

.skeleton-circle {
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

.skeleton-badge {
    height: 20px;
    width: 60px;
    display: inline-block;
}

/* =====================================================
   TASK QUEUE & DYNAMIC COMPONENTS
   ===================================================== */
.task-queue-item {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    margin-bottom: var(--sp-3);
    transition: all var(--transition-smooth);
}

.task-queue-item:hover {
    box-shadow: var(--shadow-card);
}

.clean-start-file {
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper-warm);
    border: 1px solid var(--rule-light);
    margin-bottom: var(--sp-2);
}

.context-file-checkbox {
    padding: var(--sp-3);
    background: var(--paper);
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-2);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.context-file-checkbox:hover {
    background: var(--paper-warm);
    border-color: var(--rule-dark);
}

.skill-checkbox,
.solution-checkbox {
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper);
    border: 1px solid var(--rule);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.skill-checkbox:hover,
.solution-checkbox:hover {
    background: var(--paper-warm);
}

.export-btn {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper);
    border: 1px solid var(--rule);
    cursor: pointer;
    transition: all var(--transition-fast);
    font-family: inherit;
    font-size: var(--text-sm);
}

.export-btn:hover {
    background: var(--paper-warm);
    box-shadow: var(--shadow-card);
}

/* Chat typing indicator */
.chat-typing {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: var(--sp-2);
}

.chat-typing span {
    width: 6px;
    height: 6px;
    background: var(--ink-light);
    border-radius: 50%;
    animation: typing-dot 1.4s infinite;
}

.chat-typing span:nth-child(2) {
    animation-delay: 0.2s;
}

.chat-typing span:nth-child(3) {
    animation-delay: 0.4s;
}

@keyframes typing-dot {
    0%, 60%, 100% { opacity: 0.3; transform: scale(0.8); }
    30% { opacity: 1; transform: scale(1); }
}

/* Percentage indicator */
.pct {
    font-family: 'IBM Plex Mono', monospace;
    font-size: var(--text-xs);
    font-weight: 600;
}

/* =====================================================
   SCROLLBAR STYLING
   ===================================================== */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--paper-warm);
}

::-webkit-scrollbar-thumb {
    background: var(--rule);
    border-radius: 0;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--rule-dark);
}

/* =====================================================
   ANIMATIONS
   ===================================================== */
@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

.animate-pulse {
    animation: pulse 2s ease-in-out infinite;
}

@keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

/* =====================================================
   RESPONSIVE
   ===================================================== */
@media (max-width: 1024px) {
    .sidebar {
        width: 240px;
        min-width: 240px;
    }

    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .app-container {
        flex-direction: column;
    }

    .sidebar {
        width: 100%;
        min-width: 100%;
        height: auto;
        position: relative;
        left: auto;
    }

    .content-area {
        padding: var(--sp-4);
        margin-left: 0; /* Remove sidebar offset on mobile */
    }

    .main-header {
        margin-left: 0; /* Remove sidebar offset on mobile */
    }

    .stats-grid {
        grid-template-columns: 1fr;
    }
}

/* =====================================================
   LANDING PAGE (index.html)
   ===================================================== */

/* Landing page header */
body > .header {
    background: var(--ink);
    padding: var(--sp-4) var(--sp-6);
    border-bottom: none;
}

body > .header .header-content {
    max-width: 1200px;
    margin: 0 auto;
}

body > .header .logo-icon {
    background: var(--vermillion);
}

body > .header .logo-text {
    color: var(--paper);
}

/* Header navigation - standardized across all pages */
body > .header .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    max-width: 1200px;
    margin: 0 auto;
}

body > .header .header-nav {
    display: flex;
    align-items: center;
    gap: var(--sp-4);
}

body > .header .header-link {
    display: flex;
    align-items: center;
    gap: 6px;
    color: rgba(255, 255, 255, 0.7);
    text-decoration: none;
    font-size: var(--text-sm);
    padding: 8px 12px;
    border-radius: var(--radius-md);
    transition: all var(--transition-fast);
}

body > .header .header-link:hover {
    color: white;
    background: rgba(255, 255, 255, 0.1);
}

body > .header .header-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: var(--text-sm);
    padding: 8px 14px;
    border-radius: var(--radius-md);
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: transparent;
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all var(--transition-fast);
}

body > .header .header-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    color: white;
    border-color: rgba(255, 255, 255, 0.3);
}

body > .header .header-btn.danger {
    border-color: var(--rust);
    color: #fca5a5;
}

body > .header .header-btn.danger:hover {
    background: var(--rust);
    color: white;
    border-color: var(--rust);
}

/* Main content */
body > .main {
    max-width: 1200px;
    margin: 0 auto;
    padding: var(--sp-8);
}

/* Section titles */
body > .main .section-title {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-4);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

/* Upload section */
.upload-section {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-6);
    margin-bottom: var(--sp-8);
    overflow: hidden; /* Contain grid children */
}

.upload-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--sp-4);
    margin-bottom: var(--sp-4);
}

.upload-box {
    background: var(--paper-warm);
    border: 2px dashed var(--rule);
    padding: var(--sp-6);
    text-align: center;
    cursor: pointer;
    transition: all var(--transition-smooth);
    overflow: hidden; /* Prevent content overflow */
    min-width: 0; /* Allow grid item to shrink */
}

.upload-box:hover {
    border-color: var(--scholar);
    background: var(--scholar-light);
}

.upload-box.dragover {
    border-color: var(--scholar);
    background: var(--scholar-light);
    border-style: solid;
}

.upload-box.has-files {
    border-color: var(--sage);
    border-style: solid;
    background: var(--sage-bg);
}

.upload-box-icon {
    font-size: var(--text-3xl);
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

.upload-box.has-files .upload-box-icon {
    color: var(--sage);
}

.upload-box-title {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-1);
}

.upload-box-desc {
    font-size: var(--text-sm);
    color: var(--ink-muted);
}

.upload-box-files {
    margin-top: var(--sp-3);
    overflow: hidden; /* Contain file items */
}

/* Dropzone active state for drag and drop */
.dropzone-active {
    border-color: var(--ink) !important;
    background-color: var(--paper-warm) !important;
}

.upload-file-item {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    background: var(--paper);
    padding: var(--sp-2) var(--sp-3);
    margin-bottom: var(--sp-1);
    font-size: var(--text-sm);
    text-align: left;
    min-width: 0; /* Allow flex children to shrink below content size */
}

.upload-file-item i {
    color: var(--ink-muted);
}

.upload-file-item span:first-of-type {
    flex: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.upload-file-item .remove {
    color: var(--ink-muted);
    cursor: pointer;
    padding: 2px 4px;
}

.upload-file-item .remove:hover {
    color: var(--rust);
}

#input-manuscript,
#input-reviews,
#input-supplementary {
    display: none;
}

/* AI Config */
.ai-config {
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-4);
}

.ai-config-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    cursor: pointer;
    font-size: var(--text-sm);
    font-weight: 500;
}

.ai-config-header:hover {
    background: var(--paper-dark);
}

.ai-config-chevron {
    transition: transform var(--transition-fast);
}

.ai-config-chevron.open {
    transform: rotate(180deg);
}

.ai-config-body {
    display: none;
    padding: var(--sp-4);
    border-top: 1px solid var(--rule);
}

.ai-config-body.show {
    display: block;
}

.config-row {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--sp-4);
}

.config-field label {
    display: block;
    font-size: var(--text-xs);
    font-weight: 500;
    color: var(--ink-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: var(--sp-1);
}

.config-field select {
    width: 100%;
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper);
    border: 1px solid var(--rule);
    font-family: inherit;
    font-size: var(--text-sm);
    color: var(--ink);
}

.config-field select:focus {
    outline: none;
    border-color: var(--scholar);
}

/* Upload actions */
.upload-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--sp-3);
}

/* Papers section */
.papers-section {
    margin-bottom: var(--sp-8);
}

.papers-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: var(--sp-4);
}

.paper-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
    transition: all var(--transition-smooth);
}

.paper-card:hover {
    box-shadow: var(--shadow-card);
}

.paper-info {
    flex: 1;
}

.paper-title {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-1);
    line-height: 1.3;
}

.paper-meta {
    font-size: var(--text-sm);
    color: var(--ink-muted);
}

.paper-status {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
    color: var(--ink-secondary);
}

.status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--ink-muted);
}

.status-dot.status-uploaded {
    background: var(--ink-muted);
}

.status-dot.status-processing {
    background: var(--ochre);
    animation: pulse 1.5s ease-in-out infinite;
}

.status-dot.status-parsed,
.status-dot.status-active {
    background: var(--sage);
}

.status-dot.status-error {
    background: var(--rust);
}

.paper-actions {
    display: flex;
    gap: var(--sp-2);
}

.paper-btn {
    padding: var(--sp-2) var(--sp-3);
    font-size: var(--text-sm);
    font-family: inherit;
    border: 1px solid var(--rule);
    background: var(--paper);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    transition: all var(--transition-fast);
}

.paper-btn:hover {
    background: var(--paper-warm);
}

.paper-btn-open {
    flex: 1;
    justify-content: center;
    background: var(--scholar);
    color: white;
    border-color: var(--scholar);
}

.paper-btn-open:hover {
    background: var(--scholar-dark);
}

.paper-btn-delete {
    color: var(--ink-muted);
}

.paper-btn-delete:hover {
    color: var(--rust);
    border-color: var(--rust);
}

/* Empty state */
.empty-state {
    text-align: center;
    padding: var(--sp-12);
    color: var(--ink-muted);
}

.empty-state i {
    font-size: var(--text-5xl);
    margin-bottom: var(--sp-4);
    opacity: 0.5;
}

.empty-state p {
    font-size: var(--text-sm);
}

/* Loading state */
.loading {
    text-align: center;
    padding: var(--sp-12);
    color: var(--ink-muted);
}

.loading i {
    font-size: var(--text-2xl);
    margin-bottom: var(--sp-2);
}

/* Trash section */
.trash-section {
    padding-top: var(--sp-6);
    border-top: 1px solid var(--rule);
}

.trash-section .section-title {
    color: var(--ink-muted);
}

.trash-count {
    font-size: var(--text-sm);
    font-weight: 400;
    color: var(--ink-muted);
}

/* Landing page modals - override webapp modal styles */
body > .modal#delete-modal,
body > .modal#permanent-delete-modal {
    position: fixed !important;
    inset: 0 !important;
    background: rgba(0, 0, 0, 0.5) !important;
    display: none !important;
    align-items: center !important;
    justify-content: center !important;
    z-index: 1000 !important;
    padding: var(--sp-4) !important;
    flex-direction: row !important;
    max-width: none !important;
    max-height: none !important;
    box-shadow: none !important;
    animation: none !important;
    margin: 0 !important;
}

body > .modal#delete-modal.show,
body > .modal#permanent-delete-modal.show {
    display: flex !important;
}

body > .modal#delete-modal .modal-content,
body > .modal#permanent-delete-modal .modal-content {
    background: var(--paper);
    padding: var(--sp-6);
    max-width: 400px;
    width: 100%;
    text-align: center;
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-elevated);
}

.modal-icon {
    width: 64px;
    height: 64px;
    margin: 0 auto var(--sp-4);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-3xl);
    border-radius: var(--radius-full);
    background: var(--rust-bg);
    color: var(--rust);
}

.modal-icon.warning {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.modal-title {
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
}

.modal-text {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-6);
}

.modal-actions {
    display: flex;
    gap: var(--sp-3);
    justify-content: center;
}

/* Animation */
@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.animate-slideUp {
    animation: slideUp 0.3s ease-out;
}

/* Responsive landing page */
@media (max-width: 768px) {
    .upload-grid {
        grid-template-columns: 1fr;
    }

    .config-row {
        grid-template-columns: 1fr;
    }

    .papers-grid {
        grid-template-columns: 1fr;
    }
}

/* =====================================================
   EXPERT INSIGHTS PAGE
   ===================================================== */

/* Expert page banner (full-width gradient header) */
.expert-page-header {
    background: linear-gradient(135deg, var(--scholar) 0%, #0d7377 100%);
    padding: var(--sp-6);
    color: white;
    margin-bottom: var(--sp-6);
}

.expert-page-header-content {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-4);
}

.expert-page-header-text {
    flex: 1;
}

.expert-page-header-icon {
    width: 56px;
    height: 56px;
    background: rgba(255, 255, 255, 0.2);
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-2xl);
    flex-shrink: 0;
}

.expert-page-header h3 {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 700;
    margin-bottom: var(--sp-2);
}

.expert-page-header p {
    opacity: 0.9;
    font-size: var(--text-sm);
    line-height: 1.5;
}

.expert-page-header-actions {
    margin-top: var(--sp-4);
    display: flex;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.expert-page-header-actions .btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
}

.expert-page-header-actions .btn:hover {
    background: rgba(255, 255, 255, 0.3);
}

/* Expert panel (dynamic experts display) */
.expert-panel {
    background: var(--paper);
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-6);
    padding: var(--sp-5);
}

.expert-panel-title {
    font-family: 'IBM Plex Sans', sans-serif;
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--ink-muted);
    margin-bottom: var(--sp-4);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.expert-panel-title i {
    color: var(--scholar);
}

.experts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--sp-4);
}

/* Individual expert card */
.expert-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    overflow: hidden;
    transition: all var(--transition-smooth);
}

.expert-card:hover {
    box-shadow: var(--shadow-card);
}

.expert-card-header {
    padding: var(--sp-3) var(--sp-4);
    color: white;
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.expert-card-header i {
    font-size: var(--text-lg);
    opacity: 0.9;
}

.expert-card-header .expert-name {
    font-weight: 600;
    font-size: var(--text-sm);
}

.expert-card-body {
    padding: var(--sp-4);
}

.expert-verdict {
    padding: var(--sp-2) var(--sp-3);
    margin-bottom: var(--sp-3);
    font-size: var(--text-xs);
    border: 1px solid;
}

.expert-verdict strong {
    font-weight: 600;
}

.expert-data-analysis {
    font-size: var(--text-xs);
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
}

.expert-data-analysis strong {
    color: var(--ink);
    display: block;
    margin-bottom: var(--sp-1);
}

.expert-data-analysis ul {
    margin: 0;
    padding-left: var(--sp-4);
}

.expert-data-analysis li {
    margin-bottom: var(--sp-1);
}

.expert-recommendation {
    font-size: var(--text-xs);
    color: var(--ink-secondary);
}

.expert-recommendation strong {
    color: var(--ink);
}

.expert-data-points {
    margin-top: var(--sp-3);
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-1);
}

.expert-data-point {
    padding: var(--sp-0) var(--sp-2);
    background: var(--paper-warm);
    color: var(--ink-muted);
    font-size: var(--text-2xs);
}

/* Expert color themes */
.expert-blue .expert-card-header { background: linear-gradient(135deg, #3b82f6, #2563eb); }
.expert-blue .expert-verdict { background: #eff6ff; border-color: #bfdbfe; color: #1e40af; }

.expert-red .expert-card-header { background: linear-gradient(135deg, #ef4444, #dc2626); }
.expert-red .expert-verdict { background: #fef2f2; border-color: #fecaca; color: #991b1b; }

.expert-green .expert-card-header { background: linear-gradient(135deg, #22c55e, #16a34a); }
.expert-green .expert-verdict { background: #f0fdf4; border-color: #bbf7d0; color: #166534; }

.expert-purple .expert-card-header { background: linear-gradient(135deg, #a855f7, #9333ea); }
.expert-purple .expert-verdict { background: #faf5ff; border-color: #e9d5ff; color: #6b21a8; }

.expert-orange .expert-card-header { background: linear-gradient(135deg, #f97316, #ea580c); }
.expert-orange .expert-verdict { background: #fff7ed; border-color: #fed7aa; color: #9a3412; }

.expert-cyan .expert-card-header { background: linear-gradient(135deg, #06b6d4, #0891b2); }
.expert-cyan .expert-verdict { background: #ecfeff; border-color: #a5f3fc; color: #155e75; }

.expert-brown .expert-card-header { background: linear-gradient(135deg, #d97706, #b45309); }
.expert-brown .expert-verdict { background: #fffbeb; border-color: #fde68a; color: #92400e; }

.expert-gray .expert-card-header { background: linear-gradient(135deg, #6b7280, #4b5563); }
.expert-gray .expert-verdict { background: #f9fafb; border-color: #e5e7eb; color: #374151; }

/* Stats grid */
.expert-stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: var(--sp-3);
    margin-bottom: var(--sp-6);
}

.expert-stat-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-3);
    text-align: center;
}

.expert-stat-value {
    font-family: 'IBM Plex Mono', monospace;
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--scholar);
}

.expert-stat-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Filter controls */
.expert-filters {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    margin-bottom: var(--sp-6);
}

.expert-filters-title {
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
}

.expert-filters-title i {
    color: var(--ink-muted);
}

.filter-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.filter-btn {
    padding: var(--sp-2) var(--sp-4);
    font-size: var(--text-sm);
    font-weight: 500;
    border: 1px solid var(--rule);
    background: var(--paper-warm);
    cursor: pointer;
    transition: all var(--transition-fast);
    font-family: inherit;
}

.filter-btn:hover {
    background: var(--paper-dark);
}

.filter-btn.active {
    background: var(--ink);
    color: white;
    border-color: var(--ink);
}

.filter-btn.active-red {
    background: var(--rust);
    color: white;
    border-color: var(--rust);
}

.filter-btn.active-blue {
    background: var(--scholar);
    color: white;
    border-color: var(--scholar);
}

.filter-btn.active-green {
    background: var(--sage);
    color: white;
    border-color: var(--sage);
}

.filter-btn.active-purple {
    background: #9333ea;
    color: white;
    border-color: #9333ea;
}

.filter-divider {
    width: 1px;
    background: var(--rule);
    margin: 0 var(--sp-2);
}

/* Quick nav */
.expert-quick-nav {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    margin-bottom: var(--sp-6);
}

.expert-quick-nav-title {
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
}

.quick-nav-links {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.quick-nav-link {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    font-weight: 500;
    background: var(--paper-warm);
    color: var(--ink-secondary);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.quick-nav-link:hover {
    background: var(--paper-dark);
}

.quick-nav-link.major {
    background: var(--rust-bg);
    color: var(--rust);
}

.quick-nav-link.major:hover {
    background: var(--rust);
    color: white;
}

/* Discussion card */
.discussion-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-left-width: 4px;
    margin-bottom: var(--sp-6);
    overflow: hidden;
}

.discussion-card.priority-high {
    border-left-color: var(--rust);
}

.discussion-card.priority-medium {
    border-left-color: var(--ochre);
}

.discussion-card.priority-low {
    border-left-color: var(--sage);
}

.discussion-header {
    padding: var(--sp-4);
    border-bottom: 1px solid var(--rule);
    background: var(--paper-warm);
}

.discussion-header-top {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--sp-2);
    margin-bottom: var(--sp-3);
}

.discussion-badges {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.discussion-id {
    padding: var(--sp-1) var(--sp-3);
    background: var(--ink);
    color: white !important;
    font-size: var(--text-sm);
    font-weight: 700;
    text-decoration: none;
    transition: all var(--transition-fast);
    border-bottom: none !important;
}

.discussion-id:hover,
a.discussion-id:hover,
.discussion-id.comment-link:hover {
    background: var(--scholar);
    color: white !important;
    transform: scale(1.02);
}

/* Clickable Comment Links - Universal styling for comment IDs */
.comment-link {
    color: var(--scholar);
    font-weight: 600;
    text-decoration: none;
    border-bottom: 1px dashed var(--scholar);
    cursor: pointer;
    transition: all var(--transition-fast);
    padding: 0 var(--sp-0);
    border-radius: var(--radius-xs);
}

.comment-link:hover {
    background: var(--scholar-light);
    color: var(--scholar);
    border-bottom-color: var(--scholar);
    border-bottom-style: solid;
}

/* Comment links in prose/markdown content */
.prose .comment-link,
.message-bubble .comment-link {
    font-family: 'IBM Plex Mono', monospace;
    font-size: 0.9em;
}

/* Comment links inside code blocks */
code .comment-link {
    color: var(--scholar);
    background: transparent;
    border-bottom: 1px dotted var(--scholar);
}

code .comment-link:hover {
    background: var(--scholar-light);
    border-bottom-style: solid;
}

.discussion-actions {
    display: flex;
    gap: var(--sp-2);
}

.discussion-actions .btn {
    padding: var(--sp-1) var(--sp-3);
    font-size: var(--text-xs);
}

.discussion-comment {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    line-height: 1.5;
}

.discussion-context {
    margin-top: var(--sp-2);
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-style: italic;
}

.discussion-body {
    padding: var(--sp-4);
}

.discussion-experts-title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.discussion-experts-title i {
    color: #9333ea;
}

/* Recommended response box */
.recommended-response {
    margin-top: var(--sp-4);
    padding: var(--sp-4);
    background: linear-gradient(135deg, var(--sage-bg) 0%, #e6fff9 100%);
    border: 1px solid var(--sage-border);
}

.recommended-response-title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--sage);
    margin-bottom: var(--sp-2);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.recommended-response-text {
    font-size: var(--text-xs);
    color: #065f46;
    white-space: pre-line;
    line-height: 1.6;
}

/* Advice box */
.advice-box {
    margin-top: var(--sp-3);
    padding: var(--sp-3);
    background: var(--ochre-bg);
    border: 1px solid var(--ochre-border);
}

.advice-box-title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ochre);
    margin-bottom: var(--sp-1);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.advice-box-text {
    font-size: var(--text-xs);
    color: #92400e;
}

/* Reviewer summary */
.reviewer-summary {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    margin-bottom: var(--sp-6);
}

.reviewer-summary-title {
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
}

.reviewer-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--sp-3);
}

.reviewer-card {
    padding: var(--sp-3);
    background: var(--scholar-light);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.reviewer-card:hover {
    background: #bfdbfe;
}

.reviewer-card-name {
    font-weight: 700;
    color: #1e40af;
}

.reviewer-card-meta {
    font-size: var(--text-xs);
    color: var(--scholar);
}

/* Bulk actions */
.bulk-actions {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-6);
    margin-top: var(--sp-8);
}

.bulk-actions-title {
    font-weight: 600;
    color: var(--ink-secondary);
    margin-bottom: var(--sp-4);
}

.bulk-actions-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-3);
}

/* Dynamic experts panel */
.dynamic-experts-panel {
    background: var(--paper);
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-6);
}

.dynamic-experts-header {
    padding: var(--sp-4);
    border-bottom: 1px solid var(--rule);
    background: var(--paper-warm);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.dynamic-experts-title {
    font-weight: 600;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.dynamic-experts-title i {
    color: #9333ea;
}

.dynamic-experts-badge {
    font-size: var(--text-xs);
    padding: 2px var(--sp-2);
    background: #f3e8ff;
    color: #7c3aed;
    font-weight: 500;
}

.dynamic-experts-body {
    padding: var(--sp-4);
}

.dynamic-expert-item {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-3);
    padding: var(--sp-3);
    background: var(--paper-warm);
    margin-bottom: var(--sp-2);
}

.dynamic-expert-item:last-child {
    margin-bottom: 0;
}

.dynamic-expert-icon {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    flex-shrink: 0;
    font-size: 16px;
}

.dynamic-expert-info {
    flex: 1;
    min-width: 0;
}

.dynamic-expert-name {
    font-weight: 600;
    color: var(--ink);
    font-size: var(--text-sm);
}

.dynamic-expert-expertise {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    margin-top: 2px;
}

/* No expert analysis message */
.no-expert-message {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    font-style: italic;
    padding: var(--sp-4);
    text-align: center;
}

/* =====================================================
   AI AGENTS PAGE
   ===================================================== */

/* Tip banner */
.agents-tip-banner {
    background: var(--scholar-light);
    border: 1px solid #bfdbfe;
    padding: var(--sp-5);
    margin-bottom: var(--sp-6);
    display: flex;
    align-items: flex-start;
    gap: var(--sp-4);
}

.agents-tip-icon {
    width: 40px;
    height: 40px;
    background: #dbeafe;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    border-radius: 50%;
}

.agents-tip-icon i {
    color: var(--scholar);
    font-size: var(--text-lg);
}

.agents-tip-content h3 {
    font-weight: 600;
    color: #1e3a8a;
    margin-bottom: var(--sp-1);
}

.agents-tip-content p {
    font-size: var(--text-sm);
    color: #1e40af;
    margin-bottom: var(--sp-3);
}

.agents-tip-examples {
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
}

.agents-tip-examples code {
    display: block;
    background: white;
    padding: var(--sp-2) var(--sp-3);
    font-size: var(--text-sm);
    color: #1e40af;
    font-family: 'IBM Plex Mono', monospace;
}

/* Agents section */
.agents-section {
    margin-bottom: var(--sp-8);
}

.agents-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-2);
}

.agents-section-title {
    font-weight: 600;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-base);
}

.agents-section-title i {
    color: #9333ea;
}

.agents-section-badge {
    font-size: var(--text-xs);
    padding: 2px var(--sp-2);
    background: #f3e8ff;
    color: #7c3aed;
    font-weight: 500;
}

.agents-section-desc {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-4);
}

/* Agents grid */
.agents-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: var(--sp-4);
}

/* Agent card - Academic Editorial Design */
.agent-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-5);
    cursor: pointer;
    transition: all var(--transition-smooth);
    position: relative;
}

.agent-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--scholar);
    border-radius: var(--radius-md) 0 0 var(--radius-md);
    opacity: 0;
    transition: opacity var(--transition-fast);
}

.agent-card:hover {
    border-color: var(--rule-dark);
    box-shadow: var(--shadow-md);
}

.agent-card:hover::before {
    opacity: 1;
}

.agent-card-header {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    margin-bottom: var(--sp-3);
}

.agent-icon {
    width: 48px;
    height: 48px;
    background: var(--paper-dark);
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-xl);
    color: var(--scholar);
    border: 2px solid var(--rule);
}

.agent-name {
    font-family: var(--font-display);
    font-weight: 600;
    font-size: var(--text-base);
    color: var(--ink);
}

.agent-desc {
    font-size: var(--text-sm);
    color: var(--ink-light);
    margin-bottom: var(--sp-4);
    line-height: 1.5;
}

.agent-skills {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.agent-skill {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    background: var(--paper-dark);
    color: var(--ink-light);
    border-radius: var(--radius-sm);
}

/* Agent accent colors - subtle left border accent on hover */
.agent-card.agent-methodology::before { background: var(--vermillion); }
.agent-card.agent-methodology .agent-icon { color: var(--vermillion); }

.agent-card.agent-statistics::before { background: var(--scholar); }
.agent-card.agent-statistics .agent-icon { color: var(--scholar); }

.agent-card.agent-writing::before { background: var(--sage); }
.agent-card.agent-writing .agent-icon { color: var(--sage); }

.agent-card.agent-literature::before { background: var(--rust); }
.agent-card.agent-literature .agent-icon { color: var(--rust); }

.agent-card.agent-domain::before { background: var(--ochre); }
.agent-card.agent-domain .agent-icon { color: var(--ochre); }

/* Dynamic expert cards */
.agent-card.agent-dynamic::before { background: var(--scholar); }
.agent-card.agent-dynamic .agent-icon { color: var(--scholar); }

/* Legacy color classes - map to new design */
.agent-red::before { background: var(--vermillion); }
.agent-red .agent-icon { color: var(--vermillion); }

.agent-blue::before { background: var(--scholar); }
.agent-blue .agent-icon { color: var(--scholar); }

.agent-green::before { background: var(--sage); }
.agent-green .agent-icon { color: var(--sage); }

.agent-purple::before { background: var(--rust); }
.agent-purple .agent-icon { color: var(--rust); }

.agent-orange::before { background: var(--ochre); }
.agent-orange .agent-icon { color: var(--ochre); }

.agent-cyan::before { background: var(--scholar); }
.agent-cyan .agent-icon { color: var(--scholar); }

/* Dynamic expert colors - map to design system */
.agent-card.expert-blue::before { background: var(--scholar); }
.agent-card.expert-blue .agent-icon { color: var(--scholar); }

.agent-card.expert-green::before { background: var(--sage); }
.agent-card.expert-green .agent-icon { color: var(--sage); }

.agent-card.expert-red::before { background: var(--vermillion); }
.agent-card.expert-red .agent-icon { color: var(--vermillion); }

.agent-card.expert-orange::before { background: var(--ochre); }
.agent-card.expert-orange .agent-icon { color: var(--ochre); }

.agent-card.expert-purple::before { background: var(--rust); }
.agent-card.expert-purple .agent-icon { color: var(--rust); }

.agent-card.expert-indigo::before { background: var(--scholar); }
.agent-card.expert-indigo .agent-icon { color: var(--scholar); }

.agent-card.expert-teal::before { background: var(--sage); }
.agent-card.expert-teal .agent-icon { color: var(--sage); }

/* Agent card meta info */
.agent-meta {
    margin-top: var(--sp-2);
    padding-top: var(--sp-2);
    border-top: 1px solid var(--rule);
}

.agent-comment-count {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    display: flex;
    align-items: center;
    gap: var(--sp-1);
}

.agent-comment-count i {
    font-size: var(--text-2xs);
}

/* Agent comments list - shows which comments this expert analyzed */
.agent-comments-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-1);
    margin-top: var(--sp-2);
}

.agent-comment-link {
    font-family: var(--font-mono);
    font-size: var(--text-2xs);
    font-weight: 600;
    padding: var(--sp-0) var(--sp-2);
    background: var(--ink);
    color: var(--paper);
    text-decoration: none;
    transition: all var(--transition-fast);
}

.agent-comment-link:hover {
    background: var(--scholar);
    transform: scale(1.05);
}

.agent-more {
    font-size: 10px;
    color: var(--ink-muted);
    padding: 2px 4px;
}

/* Agents prompts section */
.agents-prompts {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-6);
}

.agents-prompts-title {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
}

.agents-prompts-desc {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-4);
}

.agents-prompts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: var(--sp-3);
}

.prompt-btn {
    text-align: left;
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-warm);
    border: 1px solid var(--rule);
    font-size: var(--text-sm);
    font-family: inherit;
    cursor: pointer;
    transition: all var(--transition-fast);
    color: var(--ink-secondary);
}

.prompt-btn:hover {
    background: var(--paper-dark);
    border-color: var(--rule-dark);
}

.prompt-btn i {
    color: var(--ink-light);
    margin-right: var(--sp-2);
}

/* =====================================================
   OVERVIEW PAGE STYLES
   Academic Editorial Design - Manuscript Overview
   ===================================================== */

/* Manuscript Info Banner */
.manuscript-banner {
    background: var(--paper);
    border: 2px solid var(--scholar);
    border-left: 6px solid var(--scholar);
    border-radius: var(--radius-lg);
    padding: var(--sp-5);
    color: var(--ink);
    margin-bottom: var(--sp-6);
    box-shadow: var(--shadow-card);
    position: relative;
    overflow: hidden;
}

.manuscript-banner::before {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 200px;
    height: 200px;
    background: radial-gradient(circle, rgba(30, 58, 95, 0.05) 0%, transparent 70%);
    transform: translate(50%, -50%);
}

.manuscript-banner-content {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    position: relative;
    z-index: 1;
}

.manuscript-banner-main {
    flex: 1;
}

.manuscript-banner-title {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 700;
    margin-bottom: var(--sp-1);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    color: var(--ink);
}

.manuscript-banner-title i {
    color: var(--scholar);
}

.manuscript-banner-field {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-3);
}

.manuscript-banner-stats {
    text-align: right;
}

.manuscript-banner-stat-value {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--scholar);
}

.manuscript-banner-stat-label {
    font-size: var(--text-xs);
    color: var(--ink-light);
}

.manuscript-banner-categories {
    margin-top: var(--sp-3);
    padding-top: var(--sp-3);
    border-top: 1px solid var(--rule);
}

.manuscript-banner-cat-label {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-bottom: var(--sp-2);
}

.manuscript-banner-cat-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-1);
}

.manuscript-banner-tag {
    background: var(--scholar-light);
    color: var(--scholar);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
}

/* Empty Banner */
.manuscript-banner-empty {
    background: var(--paper-dark);
    border-color: var(--rule);
}

/* Quick Stats Grid */
.overview-stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--sp-4);
    margin-bottom: var(--sp-6);
}

@media (min-width: 768px) {
    .overview-stats-grid {
        grid-template-columns: repeat(4, 1fr);
    }
}

.overview-stat-card {
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
    border: 1px solid var(--rule);
    cursor: pointer;
    transition: all 0.2s ease;
}

.overview-stat-card:hover {
    box-shadow: var(--shadow-md);
    border-color: var(--rule-dark);
}

.overview-stat-inner {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.overview-stat-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--text-base);
}

.overview-stat-icon.comments {
    background: rgba(59, 130, 246, 0.15);
    color: var(--scholar);
}

.overview-stat-icon.major {
    background: rgba(220, 38, 38, 0.15);
    color: var(--vermillion);
}

.overview-stat-icon.high {
    background: rgba(234, 88, 12, 0.15);
    color: var(--ochre);
}

.overview-stat-icon.completed {
    background: rgba(22, 163, 74, 0.15);
    color: var(--sage);
}

.overview-stat-value {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--ink);
}

.overview-stat-value.major { color: var(--vermillion); }
.overview-stat-value.high { color: var(--ochre); }
.overview-stat-value.completed { color: var(--sage); }

.overview-stat-label {
    font-size: var(--text-xs);
    color: var(--ink-light);
}

/* Overview Panel */
.overview-panel {
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-5);
    border: 1px solid var(--rule);
    margin-bottom: var(--sp-6);
}

.overview-panel-title {
    font-family: var(--font-display);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-4);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.overview-panel-title i {
    color: var(--scholar);
}

/* Reviewers Grid */
.reviewers-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--sp-4);
}

@media (min-width: 768px) {
    .reviewers-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.reviewer-card {
    padding: var(--sp-4);
    border-radius: var(--radius-md);
    border: 2px solid var(--rule);
    cursor: pointer;
    transition: all 0.2s ease;
}

.reviewer-card:hover {
    border-color: var(--scholar);
    background: var(--paper-dark);
}

.reviewer-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-2);
}

.reviewer-card-name {
    font-weight: 700;
    color: var(--ink);
}

.reviewer-card-count {
    font-size: var(--text-sm);
    color: var(--ink-light);
}

.reviewer-card-expertise {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-bottom: var(--sp-3);
}

.reviewer-card-badges {
    display: flex;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.reviewer-badge {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
}

.reviewer-badge.major {
    background: rgba(220, 38, 38, 0.15);
    color: var(--vermillion);
}

.reviewer-badge.high {
    background: rgba(234, 88, 12, 0.15);
    color: var(--ochre);
}

.reviewer-badge.done {
    background: rgba(22, 163, 74, 0.15);
    color: var(--sage);
}

/* Comments Index Panel */
.comments-index-section {
    margin-bottom: var(--sp-4);
}

.comments-index-header {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    margin-bottom: var(--sp-2);
}

.comments-index-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.comments-index-dot.major { background: var(--vermillion); }
.comments-index-dot.minor { background: var(--scholar); }

.comments-index-label {
    font-size: var(--text-sm);
    font-weight: 700;
}

.comments-index-label.major { color: var(--vermillion); }
.comments-index-label.minor { color: var(--scholar); }

.comments-index-desc {
    font-size: var(--text-xs);
    color: var(--ink-light);
}

.comments-index-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.comment-index-btn {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-sm);
    font-weight: 500;
    border-radius: var(--radius-sm);
    border: 1px solid;
    cursor: pointer;
    transition: all 0.15s ease;
    background: none;
}

.comment-index-btn.major {
    background: rgba(220, 38, 38, 0.1);
    color: var(--vermillion);
    border-color: rgba(220, 38, 38, 0.3);
}

.comment-index-btn.major:hover {
    background: rgba(220, 38, 38, 0.2);
}

.comment-index-btn.major.high-priority {
    border-width: 2px;
    border-color: var(--vermillion);
}

.comment-index-btn.minor {
    background: rgba(59, 130, 246, 0.08);
    color: var(--scholar);
    border-color: rgba(59, 130, 246, 0.2);
}

.comment-index-btn.minor:hover {
    background: rgba(59, 130, 246, 0.15);
}

/* Priority Distribution */
.priority-distribution {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
}

.priority-row {
    cursor: pointer;
    padding: var(--sp-2);
    border-radius: var(--radius-sm);
    transition: background 0.15s ease;
}

.priority-row:hover {
    background: var(--paper-dark);
}

.priority-row-header {
    display: flex;
    justify-content: space-between;
    font-size: var(--text-sm);
    margin-bottom: var(--sp-1);
}

.priority-row-label {
    color: var(--ink-light);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.priority-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
}

.priority-dot.high { background: var(--vermillion); }
.priority-dot.medium { background: var(--ochre); }
.priority-dot.low { background: var(--sage); }

.priority-row-value {
    font-weight: 700;
}

.priority-row-value.high { color: var(--vermillion); }
.priority-row-value.medium { color: var(--ochre); }
.priority-row-value.low { color: var(--sage); }

.priority-bar {
    width: 100%;
    height: 8px;
    background: var(--rule);
    border-radius: var(--radius-sm);
    overflow: hidden;
}

.priority-bar-fill {
    height: 100%;
    border-radius: var(--radius-sm);
    transition: width 0.3s ease;
}

.priority-bar-fill.high { background: var(--vermillion); }
.priority-bar-fill.medium { background: var(--ochre); }
.priority-bar-fill.low { background: var(--sage); }

/* Categories Grid */
.categories-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.category-btn {
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper-dark);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    border: none;
    cursor: pointer;
    transition: all 0.15s ease;
    color: var(--ink);
}

.category-btn:hover {
    background: rgba(59, 130, 246, 0.15);
    color: var(--scholar);
}

.category-btn-count {
    font-weight: 700;
}

/* Two Column Grid */
.overview-two-col {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--sp-6);
    margin-bottom: var(--sp-6);
}

@media (min-width: 1024px) {
    .overview-two-col {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* High Priority Panel */
.overview-panel.high-priority {
    border-color: rgba(220, 38, 38, 0.3);
    border-left: 4px solid var(--vermillion);
}

.overview-panel-title.high-priority i {
    color: var(--vermillion);
}

.high-priority-count {
    font-size: var(--text-sm);
    font-weight: 400;
    color: var(--ink-light);
}

.high-priority-done {
    color: var(--sage);
    font-size: var(--text-sm);
    font-weight: 500;
}

/* Comments list in overview */
.overview-comments-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
}

/* =====================================================
   ALL COMMENTS PAGE STYLES
   ===================================================== */

/* Comments summary banner */
.comments-summary-banner {
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
    border: 1px solid var(--rule);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--sp-4);
    margin-bottom: var(--sp-6);
}

.comments-summary-stats {
    display: flex;
    align-items: center;
    gap: var(--sp-4);
}

.comments-summary-stat {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.comments-summary-dot {
    width: 16px;
    height: 16px;
    border-radius: var(--radius-sm);
}

.comments-summary-dot.major { background: var(--vermillion); }
.comments-summary-dot.minor { background: var(--scholar); }

.comments-summary-label {
    font-weight: 700;
}

.comments-summary-label.major { color: var(--vermillion); }
.comments-summary-label.minor { color: var(--scholar); }

.comments-summary-divider {
    color: var(--rule-dark);
}

.comments-summary-total {
    color: var(--ink-light);
}

/* Filter buttons */
.comments-filter-btns {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.filter-btn {
    padding: var(--sp-1) var(--sp-3);
    font-size: var(--text-sm);
    border-radius: var(--radius-sm);
    border: none;
    cursor: pointer;
    transition: all 0.15s ease;
}

.filter-btn.major {
    background: rgba(220, 38, 38, 0.1);
    color: var(--vermillion);
}

.filter-btn.major:hover,
.filter-btn.major.active {
    background: var(--vermillion);
    color: white;
}

.filter-btn.minor {
    background: rgba(59, 130, 246, 0.1);
    color: var(--scholar);
}

.filter-btn.minor:hover,
.filter-btn.minor.active {
    background: var(--scholar);
    color: white;
}

.filter-btn.all {
    background: var(--paper-dark);
    color: var(--ink-light);
}

.filter-btn.all:hover,
.filter-btn.all.active {
    background: var(--ink);
    color: white;
}

/* Status filter buttons */
.comments-filter-btns.status-filters {
    margin-top: var(--sp-2);
}

.filter-btn.completed {
    background: rgba(34, 197, 94, 0.1);
    color: var(--sage);
}

.filter-btn.completed:hover,
.filter-btn.completed.active {
    background: var(--sage);
    color: white;
}

.filter-btn.in-progress {
    background: rgba(251, 191, 36, 0.1);
    color: #d97706;
}

.filter-btn.in-progress:hover,
.filter-btn.in-progress.active {
    background: #d97706;
    color: white;
}

.filter-btn.pending {
    background: rgba(148, 163, 184, 0.1);
    color: var(--ink-light);
}

.filter-btn.pending:hover,
.filter-btn.pending.active {
    background: var(--ink-light);
    color: white;
}

.filter-btn i {
    margin-right: var(--sp-1);
}

/* Comments controls row */
.comments-controls {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-4);
}

.comments-controls-left {
    display: flex;
    align-items: center;
    gap: var(--sp-4);
}

.comments-sort-select {
    padding: var(--sp-2) var(--sp-3);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    background: var(--paper);
    color: var(--ink);
}

.comments-filter-badge {
    padding: var(--sp-1) var(--sp-3);
    background: rgba(59, 130, 246, 0.15);
    color: var(--scholar);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.comments-filter-badge-clear {
    color: var(--scholar);
    font-weight: 700;
    cursor: pointer;
    background: none;
    border: none;
}

.comments-filter-badge-clear:hover {
    color: var(--vermillion);
}

.comments-count {
    font-size: var(--text-sm);
    color: var(--ink-light);
}

/* Comments section */
.comments-section {
    margin-bottom: var(--sp-6);
}

.comments-section-header {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 700;
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    position: sticky;
    top: 0;
    background: var(--paper-warm);
    padding: var(--sp-2) 0;
    z-index: 10;
}

.comments-section-header.major { color: var(--vermillion); }
.comments-section-header.minor { color: var(--scholar); }

.comments-section-header .section-dot {
    width: 16px;
    height: 16px;
    border-radius: var(--radius-sm);
}

.comments-section-header.major .section-dot { background: var(--vermillion); }
.comments-section-header.minor .section-dot { background: var(--scholar); }

.comments-section-subtitle {
    font-size: var(--text-xs);
    font-weight: 400;
    color: var(--ink-light);
}

.comments-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
}

/* =====================================================
   BY REVIEWER PAGE STYLES
   ===================================================== */

.reviewer-panels {
    display: flex;
    flex-direction: column;
    gap: var(--sp-6);
}

.reviewer-panel {
    background: var(--paper);
    border-radius: var(--radius-lg);
    border: 1px solid var(--rule);
    overflow: hidden;
    transition: all 0.2s ease;
}

.reviewer-panel.collapsed {
    border-color: var(--rule-light);
}

.reviewer-panel-header {
    padding: var(--sp-5);
    border-bottom: 1px solid var(--rule-light);
    background: var(--paper-dark);
    cursor: pointer;
    display: flex;
    align-items: flex-start;
    gap: var(--sp-3);
    transition: background 0.15s ease;
}

.reviewer-panel-header:hover {
    background: var(--paper-warm);
}

.reviewer-panel.collapsed .reviewer-panel-header {
    border-bottom: none;
}

.reviewer-collapse-icon {
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--ink-muted);
    flex-shrink: 0;
    margin-top: 2px;
}

.reviewer-collapse-icon i {
    transition: transform 0.2s ease;
}

.reviewer-panel-body.hidden {
    display: none;
}

.reviewer-panel-header-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: var(--sp-3);
}

.reviewer-panel-info h3 {
    font-family: var(--font-display);
    font-weight: 700;
    font-size: var(--text-lg);
    color: var(--ink);
}

.reviewer-panel-expertise {
    font-size: var(--text-sm);
    color: var(--ink-muted);
}

.reviewer-panel-assessment {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-top: var(--sp-1);
}

.reviewer-panel-badges {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    flex-wrap: wrap;
}

.reviewer-badge {
    padding: var(--sp-1) var(--sp-3);
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    font-weight: 500;
}

.reviewer-badge.total {
    background: var(--paper-dark);
    color: var(--ink-secondary);
}

.reviewer-badge.major {
    background: rgba(220, 38, 38, 0.1);
    color: var(--vermillion);
}

.reviewer-badge.high {
    background: rgba(234, 88, 12, 0.1);
    color: var(--ochre);
}

.reviewer-badge.done {
    background: rgba(22, 163, 74, 0.1);
    color: var(--sage);
}

.reviewer-progress-mini {
    width: 60px;
    height: 4px;
    background: var(--paper);
    border-radius: var(--radius-xs);
    overflow: hidden;
}

.reviewer-progress-mini-bar {
    height: 100%;
    background: var(--sage);
    border-radius: var(--radius-xs);
    transition: width var(--transition-smooth);
}

.reviewer-controls {
    display: flex;
    justify-content: center;
    gap: var(--sp-3);
    margin-top: var(--sp-4);
    padding-top: var(--sp-4);
    border-top: 1px solid var(--rule-light);
}

.reviewer-panel-body {
    padding: var(--sp-5);
}

.reviewer-panel-comments {
    display: flex;
    flex-direction: column;
    gap: var(--sp-4);
}

.reviewer-expand-btn {
    width: 100%;
    text-align: center;
    padding: var(--sp-3);
    background: var(--paper-dark);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--scholar);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.reviewer-expand-btn:hover {
    background: var(--scholar-light);
    border-color: var(--scholar);
}

/* =====================================================
   TASK QUEUE PAGE STYLES
   ===================================================== */

.task-queue-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-6);
}

.task-queue-count {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
}

.task-queue-count-number {
    font-family: var(--font-display);
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--ink);
}

.task-queue-count-label {
    color: var(--ink-muted);
}

.task-queue-completed-badge {
    font-size: var(--text-sm);
    color: var(--sage);
    background: var(--sage-bg);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-full);
}

.task-queue-actions {
    display: flex;
    gap: var(--sp-2);
}

.task-queue-btn {
    padding: var(--sp-2) var(--sp-3);
    font-size: var(--text-sm);
    border-radius: var(--radius-md);
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.task-queue-btn.optimize {
    border: 1px solid var(--rust);
    background: var(--rust-bg);
    color: var(--rust);
}

.task-queue-btn.optimize:hover {
    background: rgba(166, 61, 47, 0.2);
}

.task-queue-btn.save {
    background: var(--scholar);
    color: white;
}

.task-queue-btn.save:hover {
    background: var(--ink);
}

/* Productivity tip */
.task-queue-tip {
    margin-bottom: var(--sp-6);
    background: linear-gradient(135deg, var(--rust-bg), var(--scholar-light));
    border: 1px solid var(--rust-border);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
}

.task-queue-tip-inner {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-3);
}

.task-queue-tip-icon {
    width: 40px;
    height: 40px;
    background: rgba(166, 61, 47, 0.15);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    color: var(--rust);
}

.task-queue-tip h4 {
    font-weight: 600;
    color: var(--ink);
}

.task-queue-tip p {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-top: var(--sp-1);
}

/* Task items */
.task-queue-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
}

.task-queue-item {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
    cursor: move;
    transition: all var(--transition-fast);
}

.task-queue-item:hover {
    box-shadow: var(--shadow-md);
}

.task-queue-item.active {
    border-color: var(--scholar);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.2);
}

.task-queue-item-inner {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-4);
}

.task-queue-drag {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.task-queue-position {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-bottom: var(--sp-1);
}

.task-queue-grip {
    color: var(--rule-dark);
}

/* Task status icon button */
.task-queue-status {
    padding-top: var(--sp-1);
}

.task-queue-status-btn {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    border: none;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    cursor: pointer;
    transition: all var(--transition-fast);
    font-size: var(--text-lg);
}

.task-queue-status-btn.pending {
    color: var(--rule-dark);
}

.task-queue-status-btn.pending:hover {
    color: var(--scholar);
    transform: scale(1.1);
}

.task-queue-status-btn.in_progress {
    color: var(--ochre);
    animation: pulse-working 2s infinite;
}

.task-queue-status-btn.completed {
    color: var(--sage);
}

.task-queue-status-btn.completed:hover {
    color: var(--vermillion);
}

@keyframes pulse-working {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.7; transform: scale(1.1); }
}

/* Task item states */
.task-queue-item.working {
    background: linear-gradient(135deg, rgba(234, 179, 8, 0.08) 0%, rgba(234, 179, 8, 0.03) 100%);
    border-left: 3px solid var(--ochre);
}

.task-queue-item.done {
    opacity: 0.6;
    background: rgba(22, 163, 74, 0.03);
}

/* Working badge */
.task-queue-working-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    font-weight: 600;
    border-radius: var(--radius-sm);
    background: var(--ochre);
    color: white;
    animation: badge-pulse 2s infinite;
}

@keyframes badge-pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
}

/* Legacy checkbox styles (keep for backwards compatibility) */
.task-queue-checkbox {
    padding-top: var(--sp-1);
}

.task-queue-check-btn {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    border: 2px solid var(--rule);
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.task-queue-check-btn.completed {
    background: var(--sage);
    border-color: var(--sage);
    color: white;
}

.task-queue-check-btn.in-progress {
    border-color: var(--scholar);
    background: var(--scholar-light);
}

.task-queue-check-btn:hover {
    border-color: var(--scholar);
}

.task-queue-content {
    flex: 1;
    min-width: 0;
}

.task-queue-meta {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    margin-bottom: var(--sp-2);
}

.task-queue-id {
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--paper);
    background: var(--ink);
    padding: var(--sp-1) var(--sp-2);
    text-decoration: none;
    cursor: pointer;
    transition: all var(--transition-fast);
}

a.task-queue-id:hover {
    background: var(--scholar);
    color: var(--paper);
    transform: scale(1.05);
}

.task-queue-type {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
}

.task-queue-type.major {
    background: rgba(220, 38, 38, 0.1);
    color: var(--vermillion);
}

.task-queue-type.minor {
    background: rgba(59, 130, 246, 0.1);
    color: var(--scholar);
}

.task-queue-priority {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
}

.task-queue-priority.high {
    background: rgba(220, 38, 38, 0.08);
    color: var(--vermillion);
}

.task-queue-priority.medium {
    background: rgba(234, 88, 12, 0.08);
    color: var(--ochre);
}

.task-queue-priority.low {
    background: rgba(22, 163, 74, 0.08);
    color: var(--sage);
}

.task-queue-category {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
    background: rgba(99, 102, 241, 0.1);
    color: var(--scholar);
    text-transform: capitalize;
}

.task-queue-text {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.task-queue-reason {
    margin-top: var(--sp-2);
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-style: italic;
}

/* Loading state */
.task-queue-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--sp-16);
}

.task-queue-loading-inner {
    text-align: center;
}

.task-queue-loading i {
    font-size: var(--text-4xl);
    color: var(--scholar);
    margin-bottom: var(--sp-4);
}

.task-queue-loading p {
    color: var(--ink-muted);
}

.task-queue-loading .small {
    font-size: var(--text-sm);
    color: var(--ink-light);
    margin-top: var(--sp-2);
}

/* =====================================================
   EXPORT PAGE STYLES (Clean Academic Design)
   ===================================================== */

.export-page {
    width: 100%;
}

.export-summary {
    margin-bottom: var(--sp-6);
    padding: var(--sp-4);
    background: var(--paper);
    border: 1px solid var(--rule);
    border-left: 4px solid var(--sage);
}

.export-summary p {
    margin: 0;
    color: var(--ink-secondary);
}

.export-section {
    margin-bottom: var(--sp-8);
}

.export-section h2 {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
    padding-bottom: var(--sp-2);
    border-bottom: 1px solid var(--rule);
}

.export-section .section-desc {
    color: var(--ink-light);
    margin-bottom: var(--sp-4);
}

.export-actions {
    display: flex;
    gap: var(--sp-3);
    flex-wrap: wrap;
}

.export-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-2);
}

.export-list-item {
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper);
    border: 1px solid var(--rule);
    text-decoration: none;
    color: var(--ink);
    transition: all var(--transition-fast);
}

.export-list-item:hover {
    border-color: var(--ink-light);
    background: var(--paper-warm);
}

.export-list-icon {
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--paper-dark);
    color: var(--ink-light);
    flex-shrink: 0;
}

.export-list-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.export-list-text strong {
    font-weight: 600;
}

.export-list-text small {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.export-note {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-top: var(--sp-3);
    font-style: italic;
}

.export-preview-box {
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-4);
    max-height: 500px;
    overflow-y: auto;
    font-size: var(--text-sm);
    line-height: 1.6;
}

/* Legacy export styles (keep for compatibility) */
.export-banner {
    margin-bottom: var(--sp-8);
    background: var(--paper);
    border: 2px solid var(--sage);
    border-left: 6px solid var(--sage);
    border-radius: var(--radius-lg);
    padding: var(--sp-6);
    color: var(--ink);
    box-shadow: var(--shadow-card);
}

.export-banner-inner {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-4);
}

.export-banner-icon {
    width: 56px;
    height: 56px;
    background: var(--sage-bg);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: var(--text-2xl);
    color: var(--sage);
}

.export-banner-content {
    flex: 1;
}

.export-banner h3 {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 700;
    margin-bottom: var(--sp-2);
    color: var(--ink);
}

.export-banner p {
    color: var(--ink-muted);
    margin-bottom: var(--sp-4);
}

.export-banner-stats {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--sp-3);
    margin-bottom: var(--sp-4);
}

@media (min-width: 768px) {
    .export-banner-stats {
        grid-template-columns: repeat(4, 1fr);
    }
}

.export-stat {
    background: var(--sage-bg);
    border: 1px solid var(--sage-border);
    border-radius: var(--radius-md);
    padding: var(--sp-3);
    text-align: center;
}

.export-stat-value {
    font-size: var(--text-2xl);
    font-weight: 700;
    color: var(--sage);
}

.export-stat-label {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.export-banner-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-3);
}

.export-banner-btn {
    padding: var(--sp-3) var(--sp-6);
    border-radius: var(--radius-md);
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: var(--sp-2);
}

.export-banner-btn.primary {
    background: var(--sage);
    color: white;
}

.export-banner-btn.primary:hover {
    background: #3a5334;
}

.export-banner-btn.secondary {
    background: var(--paper-dark);
    color: var(--ink-secondary);
    border: 1px solid var(--rule);
}

.export-banner-btn.secondary:hover {
    background: var(--rule-light);
}

/* Export cards grid */
.export-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--sp-6);
}

@media (min-width: 1024px) {
    .export-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

.export-card {
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-6);
    border: 1px solid var(--rule);
}

.export-card h3 {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-4);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.export-card h3 i.word { color: var(--scholar); }
.export-card h3 i.json { color: var(--sage); }
.export-card h3 i.summary { color: var(--rust); }
.export-card h3 i.sync { color: var(--ochre); }

.export-card p {
    font-size: var(--text-sm);
    color: var(--ink-muted);
    margin-bottom: var(--sp-4);
}

.export-options {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
    margin-bottom: var(--sp-4);
}

.export-option {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-size: var(--text-sm);
}

.export-option input[type="checkbox"] {
    width: 16px;
    height: 16px;
}

.export-card-btn {
    width: 100%;
    padding: var(--sp-3) var(--sp-4);
    border-radius: var(--radius-md);
    font-weight: 500;
    border: none;
    cursor: pointer;
    transition: all var(--transition-fast);
}

.export-card-btn.word {
    background: var(--scholar);
    color: white;
}

.export-card-btn.word:hover {
    background: var(--ink);
}

.export-card-btn.json {
    background: var(--sage);
    color: white;
}

.export-card-btn.json:hover {
    background: #3a5334;
}

.export-card-btn.summary {
    background: var(--rust);
    color: white;
}

.export-card-btn.summary:hover {
    background: #8a3127;
}

.export-card-btn.sync {
    background: var(--ochre);
    color: white;
}

.export-card-btn.sync:hover {
    background: #8a6600;
}

/* AI Rebuttal Card - Featured */
.export-card.featured {
    border: 2px solid var(--scholar);
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, var(--paper) 100%);
    position: relative;
}

.export-card.featured::before {
    content: 'AI-POWERED';
    position: absolute;
    top: -10px;
    right: var(--sp-4);
    background: var(--scholar);
    color: white;
    font-size: 10px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: var(--radius-sm);
    letter-spacing: 0.5px;
}

.export-card h3 i.ai {
    color: var(--scholar);
}

.export-features {
    list-style: none;
    padding: 0;
    margin: var(--sp-3) 0;
    font-size: var(--text-sm);
}

.export-features li {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    margin-bottom: var(--sp-1);
    color: var(--ink-light);
}

.export-features li i {
    color: var(--sage);
    font-size: var(--text-xs);
}

.export-note {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    margin-top: var(--sp-2);
    font-style: italic;
}

.export-card-btn.ai {
    background: linear-gradient(135deg, var(--scholar) 0%, #2563eb 100%);
    color: white;
}

.export-card-btn.ai:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
}

.export-card-btn.ai:disabled {
    background: var(--rule);
    cursor: not-allowed;
}

/* Export changes list */
.export-changes-panel {
    margin-top: var(--sp-6);
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-6);
    border: 1px solid var(--rule);
}

.export-changes-panel.hidden {
    display: none;
}

.export-changes-panel h3 {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-4);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.export-changes-panel h3 i {
    color: var(--sage);
}

.export-changes-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-3);
}

.export-change-item {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-3);
    padding: var(--sp-3);
    border-radius: var(--radius-md);
}

.export-change-item.terminology { background: var(--sage-bg); }
.export-change-item.period { background: var(--scholar-light); }
.export-change-item.method { background: var(--rust-bg); }

.export-change-badge {
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    border-radius: var(--radius-sm);
    font-weight: 500;
}

.export-change-item.terminology .export-change-badge {
    background: rgba(74, 103, 65, 0.2);
    color: var(--sage);
}

.export-change-item.period .export-change-badge {
    background: rgba(30, 58, 95, 0.2);
    color: var(--scholar);
}

.export-change-item.method .export-change-badge {
    background: rgba(166, 61, 47, 0.2);
    color: var(--rust);
}

.export-change-content p {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink);
}

.export-change-content p.desc {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    font-weight: 400;
}

/* Response preview */
.export-preview-panel {
    margin-top: var(--sp-6);
    background: var(--paper);
    border-radius: var(--radius-lg);
    padding: var(--sp-6);
    border: 1px solid var(--rule);
}

.export-preview-panel h3 {
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-4);
}

.export-preview-content {
    background: var(--paper-dark);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
    max-height: 500px;
    overflow-y: auto;
    font-size: var(--text-sm);
    line-height: 1.6;
}

/* Response Preview Items */
.response-preview-stats {
    margin-bottom: var(--sp-4);
    padding: var(--sp-3);
    background: var(--paper);
    border-radius: var(--radius-sm);
    color: var(--ink-light);
}

.response-count {
    font-size: var(--text-xs);
    color: var(--ink-light);
    font-weight: normal;
}

.response-preview-item {
    margin-bottom: var(--sp-3);
    padding: var(--sp-3);
    background: var(--paper);
    border-radius: var(--radius-sm);
    border-left: 3px solid var(--rule);
}

.response-preview-item.major {
    border-left-color: var(--vermillion);
}

.response-preview-item.minor {
    border-left-color: var(--scholar);
}

.response-preview-item.has-response {
    background: rgba(34, 197, 94, 0.05);
}

.response-preview-item.no-response {
    opacity: 0.7;
}

.response-preview-header {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    margin-bottom: var(--sp-2);
}

.response-preview-header .status-icon {
    font-size: var(--text-sm);
}

.response-preview-header .type-badge {
    font-size: var(--text-xs);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
}

.response-preview-header .type-badge.major {
    background: rgba(220, 38, 38, 0.1);
    color: var(--vermillion);
}

.response-preview-header .type-badge.minor {
    background: rgba(59, 130, 246, 0.1);
    color: var(--scholar);
}

.response-preview-comment {
    color: var(--ink-light);
    font-style: italic;
    margin-bottom: var(--sp-2);
}

.response-preview-response {
    padding: var(--sp-2);
    background: rgba(34, 197, 94, 0.1);
    border-radius: var(--radius-sm);
    color: var(--ink);
}

.response-preview-pending {
    color: var(--ink-muted);
    font-size: var(--text-xs);
}

.no-comments {
    color: var(--ink-muted);
    font-style: italic;
    padding: var(--sp-2);
}

/* =====================================================
   PROJECT MANAGER MODAL - Academic Card Design
   ===================================================== */

.pm-paper-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
    cursor: pointer;
    transition: all 0.2s ease;
}

.pm-paper-card:hover {
    border-color: var(--rule-dark);
    box-shadow: var(--shadow-card);
}

.pm-paper-card.selected {
    border-color: var(--scholar);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.15);
}

.pm-paper-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: var(--sp-2);
    margin-bottom: var(--sp-2);
}

.pm-paper-title {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink);
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
    flex: 1;
}

.pm-paper-delete {
    opacity: 0;
    transition: opacity 0.15s ease;
    color: var(--ink-light);
    padding: var(--sp-1);
    background: none;
    border: none;
    cursor: pointer;
}

.pm-paper-card:hover .pm-paper-delete {
    opacity: 1;
}

.pm-paper-delete:hover {
    color: var(--rust);
}

.pm-paper-journal {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    margin-bottom: var(--sp-1);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.pm-paper-authors {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-bottom: var(--sp-3);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.pm-paper-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.pm-progress-container {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.pm-progress-bar {
    width: 64px;
    height: 4px;
    background: var(--paper-dark);
    border-radius: var(--radius-xs);
    overflow: hidden;
}

.pm-progress-fill {
    height: 100%;
    border-radius: var(--radius-xs);
    transition: width var(--transition-smooth);
}

.pm-progress-fill.complete {
    background: var(--sage);
}

.pm-progress-fill.partial {
    background: var(--ink-light);
}

.pm-progress-fill.empty {
    background: var(--paper-dark);
}

.pm-progress-text {
    font-size: var(--text-xs);
    color: var(--ink-light);
}

.pm-selected-badge {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

/* Trash card variant */
.pm-trash-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
}

.pm-trash-date {
    font-size: var(--text-xs);
    color: var(--ink-light);
    margin-bottom: var(--sp-3);
}

.pm-trash-actions {
    display: flex;
    gap: var(--sp-2);
}

.pm-restore-btn {
    flex: 1;
    padding: var(--sp-1) var(--sp-2);
    background: var(--paper-dark);
    color: var(--ink);
    border: none;
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    font-weight: 500;
    cursor: pointer;
    transition: background 0.15s ease;
}

.pm-restore-btn:hover {
    background: var(--rule);
}

.pm-delete-forever-btn {
    padding: var(--sp-1) var(--sp-2);
    background: transparent;
    color: var(--rust);
    border: none;
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
    cursor: pointer;
    transition: background 0.15s ease;
}

.pm-delete-forever-btn:hover {
    background: var(--rust-bg);
}

/* Tab buttons in project manager */
.pm-tab {
    padding: var(--sp-2) var(--sp-3);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    font-weight: 500;
    border: none;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    transition: all 0.15s ease;
}

.pm-tab.active {
    background: var(--paper);
    color: var(--ink);
    box-shadow: var(--shadow-subtle);
}

.pm-tab:not(.active) {
    background: transparent;
    color: var(--ink-muted);
}

.pm-tab:not(.active):hover {
    color: var(--ink);
}

/* Category files list in add paper form */
.pm-file-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--sp-2);
    background: var(--paper-dark);
    border-radius: var(--radius-sm);
    font-size: var(--text-xs);
}

.pm-file-info {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    flex: 1;
    min-width: 0;
}

.pm-file-info i {
    color: var(--ink-light);
}

.pm-file-name {
    color: var(--ink);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.pm-file-remove {
    color: var(--ink-light);
    background: none;
    border: none;
    padding: 0;
    margin-left: var(--sp-2);
    cursor: pointer;
    flex-shrink: 0;
}

.pm-file-remove:hover {
    color: var(--rust);
}

/* Error and status colors */
.text-error {
    color: var(--rust);
}

.text-success {
    color: var(--sage);
}

.bg-success {
    background: var(--sage-bg);
}

.bg-warning {
    background: var(--ochre-bg);
}

.bg-error {
    background: var(--rust-bg);
}

/* Progress bar in regen panel */
.regen-progress-bar {
    background: var(--sage);
    height: 12px;
    border-radius: var(--radius-md);
    transition: width var(--transition-smooth);
}

/* Diff styles */
.diff-old {
    color: var(--rust);
    text-decoration: line-through;
}

.diff-new {
    color: var(--sage);
}

.diff-panel {
    background: var(--rust-bg);
    border: 1px solid var(--rust-border);
    border-radius: var(--radius-md);
    padding: var(--sp-2);
}

.diff-panel-label {
    font-size: var(--text-xs);
    color: var(--rust);
    font-weight: 500;
    margin-bottom: var(--sp-1);
}

/* =====================================================
   UTILITY CLASSES - Grid and Layout
   ===================================================== */

.grid {
    display: grid;
}

.grid-cols-2 {
    grid-template-columns: repeat(2, minmax(0, 1fr));
}

.grid-cols-3 {
    grid-template-columns: repeat(3, minmax(0, 1fr));
}

.gap-2 {
    gap: var(--sp-2);
}

.gap-3 {
    gap: var(--sp-3);
}

.gap-4 {
    gap: var(--sp-4);
}

.mb-4 {
    margin-bottom: var(--sp-4);
}

/* Line clamp utility */
.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Truncate utility */
.truncate {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* =====================================================
   RESPONSE BUILDER MODAL - Academic Style
   ===================================================== */

.rb-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
    box-shadow: var(--shadow-subtle);
}

.rb-card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    margin-bottom: var(--sp-3);
}

.rb-label {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.rb-icon-box {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: center;
}

.rb-icon-box.blue { background: var(--scholar-light); }
.rb-icon-box.blue i { color: var(--scholar); }

.rb-icon-box.amber { background: var(--ochre-bg); }
.rb-icon-box.amber i { color: var(--ochre); }

.rb-icon-box.green { background: var(--sage-bg); }
.rb-icon-box.green i { color: var(--sage); }

.rb-icon-box.purple { background: rgba(147, 51, 234, 0.1); }
.rb-icon-box.purple i { color: #9333ea; }

.rb-icon-box.indigo { background: rgba(79, 70, 229, 0.1); }
.rb-icon-box.indigo i { color: #4f46e5; }

.rb-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
}

.rb-tag {
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
}

.rb-tag.location { background: var(--paper-dark); color: var(--ink-muted); }
.rb-tag.type { background: rgba(147, 51, 234, 0.1); color: #9333ea; }
.rb-tag.category { background: var(--scholar-light); color: var(--scholar); }

.rb-comment-text {
    background: linear-gradient(135deg, var(--scholar-light) 0%, var(--paper-warm) 100%);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
    font-size: var(--text-sm);
    color: var(--ink);
    line-height: 1.6;
}

.rb-two-column {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--sp-4);
}

@media (max-width: 1024px) {
    .rb-two-column {
        grid-template-columns: 1fr;
    }
}

.rb-column {
    display: flex;
    flex-direction: column;
    gap: var(--sp-4);
}

/* Expert Analysis in Modal */
.rb-expert-analysis {
    border-color: rgba(147, 51, 234, 0.2);
}

.rb-experts-summary {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
    margin-bottom: var(--sp-3);
}

.rb-expert-chip {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    padding: var(--sp-1) var(--sp-2);
    background: var(--paper-warm);
    border: 1px solid var(--rule);
    border-radius: var(--radius-full);
    font-size: var(--text-xs);
    cursor: default;
}

.rb-expert-chip i {
    color: var(--ink-muted);
}

.rb-expert-name {
    font-weight: 500;
    color: var(--ink);
}

.rb-expert-verdict {
    font-weight: 600;
    padding: 0 var(--sp-1);
    border-radius: var(--radius-sm);
}

.rb-expert-verdict.agree { background: var(--sage-bg); color: var(--sage); }
.rb-expert-verdict.disagree { background: var(--vermillion-light); color: var(--vermillion); }
.rb-expert-verdict.partial { background: var(--ochre-bg); color: var(--ochre); }

.rb-recommended-response {
    background: var(--sage-bg);
    border: 1px solid var(--sage-border);
    border-radius: var(--radius-md);
    padding: var(--sp-3);
    margin-bottom: var(--sp-3);
}

.rb-rec-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--sp-2);
}

.rb-rec-label {
    font-size: var(--text-xs);
    font-weight: 600;
    color: var(--sage);
    display: flex;
    align-items: center;
    gap: var(--sp-1);
}

.rb-rec-text {
    font-size: var(--text-sm);
    color: var(--ink);
    line-height: 1.5;
    margin: 0;
}

.rb-advice {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-3);
    background: var(--ochre-bg);
    border-radius: var(--radius-md);
    font-size: var(--text-xs);
    color: var(--ochre);
}

.rb-advice i {
    color: var(--ochre);
    margin-top: 2px;
}

.rb-no-analysis {
    background: var(--paper-warm);
    border-style: dashed;
}

.rb-empty-text {
    color: var(--ink-muted);
    font-size: var(--text-sm);
    font-style: italic;
    margin: var(--sp-2) 0;
}

/* Loading overlay for expert analysis in modal */
.rb-loading-overlay {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: var(--sp-6);
    gap: var(--sp-3);
    color: #9333ea;
    font-size: var(--text-sm);
    font-weight: 500;
}

.rb-loading-overlay i {
    font-size: 2rem;
}

.rb-loading-overlay.hidden {
    display: none;
}

/* Solutions checklist */
.rb-solutions-list {
    display: flex;
    flex-direction: column;
    gap: var(--sp-1);
    margin-top: var(--sp-3);
    max-height: 160px;
    overflow-y: auto;
}

.rb-solution-item {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-2);
    padding: var(--sp-2);
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: var(--text-sm);
}

.rb-solution-item:hover {
    background: var(--ochre-bg);
}

.rb-solution-item input {
    margin-top: 2px;
}

.rb-solution-item span {
    color: var(--ink);
}

/* AI-generated solution cards in Response Builder modal */
.rb-ai-solution {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-3);
    margin-bottom: var(--sp-3);
    transition: all 0.2s ease;
}

.rb-ai-solution:hover {
    border-color: var(--ink-light);
    box-shadow: var(--shadow-elevated);
}

.rb-ai-solution.recommended {
    border-color: var(--sage);
    background: var(--sage-bg);
}

.rb-ai-solution .rb-solution-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--sp-2);
}

.rb-ai-solution .rb-solution-title {
    font-weight: 600;
    font-size: var(--text-sm);
    color: var(--ink);
}

.rb-ai-solution .rb-solution-effort {
    font-size: var(--text-xs);
    padding: 2px 8px;
    border-radius: 12px;
    font-weight: 500;
    text-transform: uppercase;
}

.rb-ai-solution .rb-solution-effort.effort-low {
    background: var(--sage-bg);
    color: var(--sage);
}

.rb-ai-solution .rb-solution-effort.effort-medium {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.rb-ai-solution .rb-solution-effort.effort-high {
    background: var(--coral-bg);
    color: var(--coral);
}

.rb-ai-solution .rb-solution-response {
    font-size: var(--text-sm);
    color: var(--ink-light);
    line-height: 1.5;
    margin-bottom: var(--sp-3);
    max-height: 120px;
    overflow-y: auto;
}

.rb-ai-solution .rb-solution-preview {
    font-size: var(--text-xs);
    color: var(--ink-muted);
    line-height: 1.4;
    margin-bottom: var(--sp-2);
    font-style: italic;
}

.rb-ai-solution button {
    width: 100%;
}

.rb-custom-input {
    width: 100%;
    padding: var(--sp-2) var(--sp-3);
    font-size: var(--text-sm);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    background: var(--paper-dark);
}

.rb-custom-input:focus {
    background: var(--paper);
    border-color: var(--ochre);
    outline: none;
    box-shadow: 0 0 0 2px var(--ochre-bg);
}

/* Actions taken list */
.rb-actions-list {
    font-size: var(--text-sm);
    color: var(--ink);
    margin-top: var(--sp-3);
}

.rb-actions-list ul {
    display: flex;
    flex-direction: column;
    gap: var(--sp-1);
}

.rb-actions-list li {
    display: flex;
    align-items: flex-start;
    gap: var(--sp-2);
}

.rb-actions-list li i {
    color: var(--sage);
    margin-top: 4px;
    font-size: var(--text-xs);
}

.rb-empty-text {
    color: var(--ink-light);
    font-style: italic;
    font-size: var(--text-sm);
}

/* Ask OpenCode panel */
.rb-ai-panel {
    background: linear-gradient(135deg, var(--sage-bg) 0%, rgba(74, 103, 65, 0.05) 100%);
    border: 1px solid var(--sage-border);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
}

.rb-ai-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-3);
}

.rb-ai-label {
    font-size: var(--text-sm);
    font-weight: 500;
    color: var(--ink);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.rb-ai-icon {
    width: 28px;
    height: 28px;
    background: var(--scholar-light);
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
}

.rb-ai-icon i {
    color: var(--scholar);
    font-size: var(--text-xs);
}

.rb-status-badge {
    font-size: var(--text-xs);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-full);
    background: var(--paper-dark);
    color: var(--ink-muted);
}

/* Skill checkboxes */
.rb-skills {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: var(--sp-3);
}

.rb-skill-label {
    display: inline-flex;
    align-items: center;
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-xs);
    cursor: pointer;
    transition: border-color 0.15s ease;
}

.rb-skill-label:hover {
    border-color: var(--sage);
}

.rb-skill-label input {
    margin-right: 6px;
}

/* Context status */
.rb-context-status {
    margin-bottom: var(--sp-3);
    padding: var(--sp-2);
    border-radius: var(--radius-md);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.rb-context-status.loaded {
    background: var(--sage-bg);
}

.rb-context-status.not-loaded {
    background: var(--ochre-bg);
}

.rb-context-info {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.rb-context-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.rb-context-dot.loaded { background: var(--sage); }
.rb-context-dot.not-loaded { background: var(--ochre); }

.rb-context-text {
    font-size: var(--text-xs);
}

.rb-context-text.loaded { color: var(--sage); }
.rb-context-text.not-loaded { color: var(--ochre); }

.rb-context-btn {
    font-size: var(--text-xs);
    color: var(--scholar);
    font-weight: 500;
    background: none;
    border: none;
    cursor: pointer;
    text-decoration: underline;
}

.rb-model-info {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-3);
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.rb-model-info strong {
    color: var(--ink);
}

.rb-model-info a {
    color: var(--sage);
}

.rb-generate-btn {
    width: 100%;
    padding: var(--sp-3) var(--sp-4);
    background: linear-gradient(135deg, var(--sage) 0%, #3d5a34 100%);
    color: white;
    border: none;
    border-radius: var(--radius-lg);
    font-weight: 500;
    cursor: pointer;
    box-shadow: var(--shadow-subtle);
    transition: all 0.15s ease;
}

.rb-generate-btn:hover {
    box-shadow: var(--shadow-card);
}

.rb-generate-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.rb-loading {
    margin-top: var(--sp-3);
    text-align: center;
    padding: var(--sp-3);
}

.rb-loading i {
    color: var(--sage);
    font-size: var(--text-xl);
    margin-bottom: var(--sp-2);
}

.rb-loading p {
    font-size: var(--text-sm);
    color: var(--ink-muted);
}

/* Response editor */
.rb-editor-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-3);
}

.rb-editor-actions {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.rb-history-btn {
    font-size: var(--text-xs);
    padding: var(--sp-1) var(--sp-2);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    background: transparent;
    color: var(--ink-muted);
    cursor: pointer;
    transition: background 0.15s ease;
}

.rb-history-btn:hover {
    background: var(--paper-dark);
}

.rb-status-select {
    font-size: var(--text-xs);
    padding: var(--sp-1) var(--sp-3);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    background: var(--paper-dark);
}

.rb-textarea {
    width: 100%;
    min-height: 200px;
    padding: var(--sp-3);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    font-family: var(--font-body);
    font-size: var(--text-sm);
    line-height: 1.6;
    resize: vertical;
    background: var(--paper);
}

.rb-textarea:focus {
    outline: none;
    border-color: var(--scholar);
    box-shadow: 0 0 0 2px var(--scholar-light);
}

.rb-editor-footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-top: var(--sp-2);
}

.rb-char-count {
    font-size: var(--text-xs);
    color: var(--ink-light);
}

.rb-format-btns {
    display: flex;
    gap: var(--sp-1);
}

.rb-format-btn {
    padding: var(--sp-1);
    background: var(--paper-dark);
    border: none;
    border-radius: var(--radius-sm);
    color: var(--ink-muted);
    cursor: pointer;
    font-size: var(--text-sm);
}

.rb-format-btn:hover {
    background: var(--rule);
    color: var(--ink);
}

/* Preview panel */
.rb-preview {
    background: var(--paper-dark);
    border-radius: var(--radius-md);
    padding: var(--sp-4);
    min-height: 100px;
    font-size: var(--text-sm);
    line-height: 1.6;
}

.rb-preview:empty::before {
    content: 'Preview will appear here...';
    color: var(--ink-light);
    font-style: italic;
}

/* Version history */
.rb-version-item {
    padding: var(--sp-3);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    margin-bottom: var(--sp-2);
}

.rb-version-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: var(--sp-2);
}

.rb-version-date {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.rb-version-source {
    font-size: var(--text-xs);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-sm);
}

.rb-version-source.ai {
    background: var(--sage-bg);
    color: var(--sage);
}

.rb-version-source.manual {
    background: var(--scholar-light);
    color: var(--scholar);
}

.rb-version-text {
    font-size: var(--text-sm);
    color: var(--ink);
    line-height: 1.5;
}

/* Related comment item */
.related-comment-item {
    padding: var(--sp-3);
    background: var(--paper-dark);
    border: 1px solid var(--rule);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.15s ease;
}

.related-comment-item:hover {
    border-color: var(--scholar);
    box-shadow: var(--shadow-subtle);
}

/* =====================================================
   GO TO TOP BUTTON
   ===================================================== */

.go-to-top-btn {
    position: fixed;
    bottom: var(--sp-6);
    left: var(--sp-6);
    width: 44px;
    height: 44px;
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
    z-index: 100;
    box-shadow: var(--shadow-card);
    color: var(--ink-muted);
}

.go-to-top-btn.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

.go-to-top-btn:hover {
    background: var(--scholar);
    border-color: var(--scholar);
    color: white;
    box-shadow: var(--shadow-elevated);
}

.go-to-top-btn i {
    font-size: 16px;
}

/* =====================================================
   GENERAL UI/UX IMPROVEMENTS
   ===================================================== */

/* Better focus states for accessibility */
*:focus-visible {
    outline: 2px solid var(--scholar);
    outline-offset: 2px;
}

button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
    outline: 2px solid var(--scholar);
    outline-offset: 2px;
}

/* Smooth scroll behavior */
html {
    scroll-behavior: smooth;
}

/* Better text selection */
::selection {
    background: var(--scholar-light);
    color: var(--ink);
}

/* Loading state for buttons */
.btn.loading {
    pointer-events: none;
    opacity: 0.7;
}

.btn.loading::after {
    content: '';
    display: inline-block;
    width: 12px;
    height: 12px;
    margin-left: 8px;
    border: 2px solid currentColor;
    border-right-color: transparent;
    border-radius: 50%;
    animation: spin 0.6s linear infinite;
}

/* Empty state styles */
.empty-state {
    text-align: center;
    padding: var(--sp-12) var(--sp-6);
    color: var(--ink-muted);
}

.empty-state-icon {
    font-size: var(--text-5xl);
    margin-bottom: var(--sp-4);
    opacity: 0.4;
}

.empty-state-title {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-2);
}

.empty-state-text {
    font-size: var(--text-sm);
    max-width: 400px;
    margin: 0 auto var(--sp-4);
    line-height: 1.5;
}

/* Skeleton loading animation */
.skeleton {
    background: linear-gradient(90deg, var(--paper-dark) 25%, var(--paper-warm) 50%, var(--paper-dark) 75%);
    background-size: 200% 100%;
    animation: skeleton-loading 1.5s ease-in-out infinite;
}

@keyframes skeleton-loading {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

.skeleton-text {
    height: 14px;
    border-radius: var(--radius-sm);
    margin-bottom: var(--sp-2);
}

.skeleton-title {
    height: 20px;
    width: 60%;
    border-radius: var(--radius-sm);
    margin-bottom: var(--sp-3);
}

/* Pulse animation for notifications */
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.pulse {
    animation: pulse 2s ease-in-out infinite;
}

/* Fade in animation */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.fade-in {
    animation: fadeIn 0.3s ease-out;
}

/* Slide in from right */
@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(20px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.slide-in-right {
    animation: slideInRight 0.3s ease-out;
}

/* Better tooltips base */
[title] {
    position: relative;
}

/* Improved notification toast */
.notification-toast {
    position: fixed;
    bottom: 80px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--ink);
    color: white;
    padding: var(--sp-3) var(--sp-5);
    font-size: var(--text-sm);
    z-index: 1000;
    box-shadow: var(--shadow-elevated);
    border-radius: var(--radius-md);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
}

.notification-toast.show {
    opacity: 1;
    visibility: visible;
    transform: translateX(-50%) translateY(0);
}

.notification-toast.success {
    background: var(--sage);
}

.notification-toast.error {
    background: var(--rust);
}

.notification-toast.warning {
    background: var(--ochre);
}

/* Better scrollbar styling */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: var(--paper-dark);
}

::-webkit-scrollbar-thumb {
    background: var(--rule);
    border-radius: var(--radius-sm);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--rule-dark);
}

/* Keyboard shortcut hint */
kbd {
    display: inline-block;
    padding: var(--sp-0) var(--sp-2);
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    background: var(--paper-dark);
    border: 1px solid var(--rule);
    border-radius: var(--radius-xs);
    box-shadow: 0 1px 0 var(--rule);
}

/* Visually hidden but accessible */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Quick action pill buttons */
.quick-actions {
    display: flex;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.quick-action-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--sp-1);
    padding: var(--sp-1) var(--sp-3);
    font-size: var(--text-xs);
    font-weight: 500;
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-full);
    color: var(--ink-muted);
    cursor: pointer;
    transition: all 0.15s ease;
}

.quick-action-btn:hover {
    background: var(--scholar-light);
    border-color: var(--scholar);
    color: var(--scholar);
}

.quick-action-btn i {
    font-size: var(--text-2xs);
}

/* =====================================================
   TERMINAL MODAL - AI Optimization Logging
   Academic Editorial Style
   ===================================================== */

.terminal-modal {
    background: var(--paper);
    border: 2px solid var(--ink);
    border-radius: 0;
    width: 90%;
    max-width: 700px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 8px 8px 0 var(--ink);
    animation: terminalSlideIn 0.3s ease;
    overflow: hidden;
}

@keyframes terminalSlideIn {
    from {
        opacity: 0;
        transform: translateY(-20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.modal-overlay.closing .terminal-modal {
    animation: terminalSlideOut 0.2s ease forwards;
}

@keyframes terminalSlideOut {
    to {
        opacity: 0;
        transform: translateY(-10px);
    }
}

.terminal-header {
    display: flex;
    align-items: center;
    padding: var(--sp-3) var(--sp-4);
    background: var(--ink);
    border-bottom: none;
}

.terminal-dots {
    display: flex;
    gap: 6px;
    margin-right: var(--sp-4);
}

.terminal-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    border: 1px solid rgba(255,255,255,0.2);
}

.terminal-dot.red { background: var(--vermillion); }
.terminal-dot.yellow { background: var(--ochre); }
.terminal-dot.green { background: var(--sage); }

.terminal-title {
    flex: 1;
    font-family: 'IBM Plex Mono', monospace;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--paper);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.terminal-close {
    background: none;
    border: none;
    color: var(--paper);
    opacity: 0.7;
    cursor: pointer;
    padding: var(--sp-1) var(--sp-2);
    font-size: var(--text-sm);
    transition: opacity var(--transition-fast);
}

.terminal-close:hover {
    opacity: 1;
}

.terminal-body {
    flex: 1;
    overflow-y: auto;
    padding: var(--sp-4);
    font-family: var(--font-mono);
    font-size: var(--text-sm);
    line-height: 1.7;
    color: var(--ink);
    background: var(--paper-warm);
    min-height: 300px;
    max-height: 50vh;
    border-left: 3px solid var(--ink);
    margin-left: var(--sp-2);
}

.terminal-line {
    margin-bottom: 6px;
    display: flex;
    align-items: flex-start;
    gap: var(--sp-2);
    padding: 2px 0;
}

.terminal-line.header {
    margin-top: var(--sp-4);
    margin-bottom: var(--sp-2);
    padding-bottom: var(--sp-1);
    border-bottom: 1px solid var(--rule);
}

.terminal-prompt {
    color: var(--sage);
    font-weight: 700;
}

.terminal-command {
    color: var(--scholar);
    font-weight: 500;
}

.terminal-info {
    color: var(--ink-muted);
}

.terminal-success {
    color: var(--sage);
    font-weight: 600;
}

.terminal-error {
    color: var(--vermillion);
    font-weight: 600;
}

.terminal-reasoning {
    color: var(--scholar);
}

.reasoning-text {
    color: var(--ink-secondary);
    font-style: italic;
    font-family: var(--font-body);
    font-size: var(--text-sm);
}

.terminal-task {
    color: var(--rust);
    font-weight: 500;
}

.terminal-header-text {
    color: var(--ink);
    font-weight: 700;
    text-transform: uppercase;
    font-size: var(--text-2xs);
    letter-spacing: 1px;
}

.terminal-line strong {
    color: var(--vermillion);
    font-weight: 600;
}

.terminal-footer {
    padding: var(--sp-3) var(--sp-4);
    background: var(--paper-dark);
    border-top: 2px solid var(--ink);
}

.terminal-status {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    color: var(--ink-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.terminal-status i {
    color: var(--scholar);
}

.terminal-status .fa-check-circle {
    color: var(--sage);
}

.terminal-status .fa-exclamation-circle {
    color: var(--vermillion);
}

/* Terminal scrollbar - Academic style */
.terminal-body::-webkit-scrollbar {
    width: 6px;
}

.terminal-body::-webkit-scrollbar-track {
    background: var(--paper-dark);
}

.terminal-body::-webkit-scrollbar-thumb {
    background: var(--ink-light);
    border-radius: 0;
}

.terminal-body::-webkit-scrollbar-thumb:hover {
    background: var(--ink);
}

/* =====================================================
   OPENCODE OVERLAY (blocking modal)
   ===================================================== */
.opencode-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
}

.opencode-overlay-content {
    background: var(--ink);
    color: var(--paper);
    padding: var(--sp-6) var(--sp-8);
    border-radius: 8px;
    text-align: center;
    box-shadow: var(--shadow-dramatic);
}

.opencode-overlay-content i {
    font-size: 32px;
    margin-bottom: var(--sp-4);
    display: block;
}

.opencode-overlay-content div {
    font-size: var(--text-base);
    font-weight: 500;
}

/* =====================================================
   POTENTIAL SOLUTIONS (Expert Insights view)
   ===================================================== */
.potential-solutions {
    margin-top: var(--sp-4);
    padding-top: var(--sp-4);
    border-top: 1px solid var(--rule);
}

.potential-solutions-title {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--ink);
    margin-bottom: var(--sp-3);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.potential-solutions-title i {
    color: var(--ochre);
}

.solutions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: var(--sp-3);
}

.solution-card {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: 8px;
    padding: var(--sp-4);
    transition: all 0.2s ease;
}

.solution-card:hover {
    border-color: var(--ink-light);
    box-shadow: var(--shadow-elevated);
}

.solution-card.recommended {
    border-color: var(--sage);
    background: var(--sage-bg);
}

.solution-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--sp-2);
}

.solution-title {
    font-weight: 600;
    font-size: var(--text-sm);
    color: var(--ink);
}

.solution-effort {
    font-size: var(--text-xs);
    padding: 2px 8px;
    border-radius: 4px;
    font-weight: 500;
    text-transform: uppercase;
}

.solution-effort.effort-low {
    background: var(--sage-bg);
    color: var(--sage);
}

.solution-effort.effort-medium {
    background: var(--ochre-bg);
    color: var(--ochre);
}

.solution-effort.effort-high {
    background: var(--rust-bg);
    color: var(--rust);
}

.solution-text {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    line-height: 1.5;
    margin-bottom: var(--sp-3);
    max-height: 100px;
    overflow-y: auto;
}

.solution-card .btn {
    width: 100%;
}

/* =====================================================
   PROGRESS WIDGET (modal for bulk operations)
   ===================================================== */
#progress-widget {
    position: fixed;
    bottom: 70px;
    right: var(--sp-4);
    width: 320px;
    background: var(--paper);
    border: 1px solid var(--rule);
    box-shadow: var(--shadow-dramatic);
    z-index: 901;
    border-radius: 8px;
    overflow: hidden;
}

#progress-widget .progress-header {
    padding: var(--sp-3) var(--sp-4);
    background: var(--ink);
    color: var(--paper);
    display: flex;
    align-items: center;
    justify-content: space-between;
}

#progress-widget .progress-body {
    padding: var(--sp-4);
}

/* =====================================================
   NOTIFICATION TOAST (centered bottom)
   ===================================================== */
.notification-toast {
    position: fixed;
    bottom: var(--sp-6);
    left: 50%;
    transform: translateX(-50%);
    background: var(--ink);
    color: white;
    padding: var(--sp-3) var(--sp-5);
    font-size: var(--text-sm);
    z-index: 1000;
    box-shadow: var(--shadow-elevated);
    border-radius: 8px;
    display: flex;
    align-items: center;
    gap: var(--sp-3);
    animation: slideUp 0.3s ease-out;
    max-width: 400px;
}

.notification-toast[data-type="success"] {
    background: var(--sage);
}

.notification-toast[data-type="error"] {
    background: var(--rust);
}

.notification-toast[data-type="warning"] {
    background: var(--ochre);
}

.notification-toast[data-type="info"] {
    background: var(--scholar);
}

.notification-toast .notification-icon {
    font-size: 16px;
    flex-shrink: 0;
}

.notification-toast .notification-message {
    flex-grow: 1;
}

.notification-toast.fade-out {
    animation: slideDown 0.3s ease-out forwards;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translate(-50%, 10px);
    }
    to {
        opacity: 1;
        transform: translate(-50%, 0);
    }
}

@keyframes slideDown {
    from {
        opacity: 1;
        transform: translate(-50%, 0);
    }
    to {
        opacity: 0;
        transform: translate(-50%, 10px);
    }
}

/* =====================================================
   MANUSCRIPT CONTEXT - Line Reference Display
   ===================================================== */
.manuscript-context-box {
    background: var(--paper-aged);
    border: 1px solid var(--rule);
    border-left: 3px solid var(--scholar);
    padding: var(--sp-3);
    margin-top: var(--sp-3);
    border-radius: 4px;
}

.manuscript-context-label {
    font-size: var(--text-sm);
    color: var(--ink-secondary);
    margin-bottom: var(--sp-2);
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.manuscript-context-label i {
    color: var(--scholar);
}

.manuscript-context-text {
    font-family: var(--font-mono);
    font-size: 12px;
    line-height: 1.6;
    background: var(--paper);
    border: 1px solid var(--rule);
    padding: var(--sp-3);
    overflow-x: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
    margin: 0;
    max-height: 300px;
    overflow-y: auto;
}

.manuscript-context-text .highlighted-line {
    background: var(--ochre-bg);
    color: var(--ochre);
    font-weight: 600;
    padding: 0 2px;
    border-radius: 2px;
}

/* Compact version for card view */
.comment-card .manuscript-context-box {
    margin-top: var(--sp-2);
}

.comment-card .manuscript-context-text {
    max-height: 200px;
    font-size: 11px;
}

/* =====================================================
   COLLABORATION EXPORT
   ===================================================== */

.collab-export-panel {
    background: var(--paper);
    border: 1px solid var(--rule);
    border-radius: var(--radius-lg);
    padding: var(--sp-4);
}

.collab-select-controls {
    display: flex;
    flex-wrap: wrap;
    gap: var(--sp-2);
    margin-bottom: var(--sp-4);
    padding-bottom: var(--sp-3);
    border-bottom: 1px solid var(--rule-light);
    align-items: center;
}

.collab-count {
    margin-left: auto;
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--scholar);
    background: var(--scholar-light);
    padding: var(--sp-1) var(--sp-3);
    border-radius: var(--radius-full);
}

.collab-comments-list {
    max-height: 400px;
    overflow-y: auto;
    margin-bottom: var(--sp-4);
}

.collab-reviewer-group {
    margin-bottom: var(--sp-4);
}

.collab-reviewer-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--sp-2) var(--sp-3);
    background: var(--paper-warm);
    border-radius: var(--radius-md);
    margin-bottom: var(--sp-2);
}

.collab-reviewer-header strong {
    color: var(--ink);
    font-size: var(--text-sm);
}

.collab-reviewer-count {
    font-size: var(--text-xs);
    color: var(--ink-muted);
}

.collab-reviewer-comments {
    display: flex;
    flex-direction: column;
    gap: var(--sp-1);
}

.collab-comment-item {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    padding: var(--sp-2) var(--sp-3);
    border: 1px solid var(--rule-light);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all 0.15s ease;
    font-size: var(--text-sm);
}

.collab-comment-item:hover {
    background: var(--paper-warm);
    border-color: var(--rule);
}

.collab-comment-item.selected {
    background: var(--scholar-light);
    border-color: var(--scholar);
}

.collab-comment-item input[type="checkbox"] {
    width: 16px;
    height: 16px;
    flex-shrink: 0;
}

.collab-comment-id {
    font-weight: 600;
    color: var(--scholar);
    min-width: 50px;
}

.collab-comment-type {
    font-size: var(--text-xs);
    padding: 2px 6px;
    border-radius: var(--radius-sm);
    text-transform: uppercase;
    font-weight: 500;
}

.collab-comment-type.badge-major {
    background: var(--vermillion-light);
    color: var(--vermillion);
}

.collab-comment-type.badge-minor {
    background: var(--paper-dark);
    color: var(--ink-muted);
}

.collab-comment-text {
    flex: 1;
    color: var(--ink-muted);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.collab-has-response {
    color: var(--sage);
    flex-shrink: 0;
}

.collab-export-actions {
    display: flex;
    justify-content: flex-end;
    padding-top: var(--sp-3);
    border-top: 1px solid var(--rule-light);
}

.collab-empty {
    text-align: center;
    color: var(--ink-muted);
    padding: var(--sp-6);
    font-style: italic;
}

/* Comment card selection checkbox */
.collab-checkbox-wrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin-right: var(--sp-1);
}

.collab-card-checkbox {
    width: 16px;
    height: 16px;
    cursor: pointer;
    accent-color: var(--scholar);
}

.comment-card.collab-selected {
    border-color: var(--scholar);
    background: linear-gradient(135deg, var(--scholar-light) 0%, var(--paper) 100%);
    box-shadow: 0 0 0 2px rgba(30, 58, 95, 0.1);
}

/* Collaboration Selection Toolbar */
.collab-selection-toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--sp-2) var(--sp-3);
    background: var(--scholar-light);
    border: 1px solid rgba(30, 58, 95, 0.15);
    border-radius: var(--radius-md);
    margin-bottom: var(--sp-4);
}

.collab-toolbar-left {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
    flex-wrap: wrap;
}

.collab-toolbar-icon {
    color: var(--scholar);
    font-size: 1rem;
}

.collab-toolbar-label {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--scholar);
    margin-right: var(--sp-1);
}

.collab-toolbar-right {
    display: flex;
    align-items: center;
    gap: var(--sp-2);
}

.collab-toolbar-count {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--scholar);
    background: var(--paper);
    padding: var(--sp-1) var(--sp-2);
    border-radius: var(--radius-full);
}

.btn-xs {
    font-size: var(--text-xs);
    padding: 4px 8px;
}
