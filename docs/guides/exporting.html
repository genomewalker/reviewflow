<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exporting - Rebuttr Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/docs.css">
</head>
<body>
    <nav class="doc-nav" id="nav">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <span class="logo-mark">RF</span>
                <span class="logo-text">Rebuttr</span>
            </a>
            <ul class="nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="https://github.com/genomewalker/rebuttr">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <div class="doc-layout">
        <aside class="doc-sidebar">
            <h4>Getting started</h4>
            <a href="installation.html">Installation</a>
            <a href="quickstart.html">Quick start</a>
            <a href="../tutorial.html">Tutorial</a>

            <h4>User guide</h4>
            <a href="importing.html">Importing reviews</a>
            <a href="ai-features.html">AI features</a>
            <a href="exporting.html" class="active">Exporting</a>
            <a href="multi-paper.html">Multi-paper</a>

            <h4>Configuration</h4>
            <a href="configuration.html">Configuration</a>
            <a href="cli-reference.html">CLI reference</a>
            <a href="skills.html">AI skills</a>

            <h4>Reference</h4>
            <a href="../api/">API reference</a>
            <a href="json-format.html">JSON format</a>
            <a href="troubleshooting.html">Troubleshooting</a>
        </aside>

        <main class="doc-content">
            <h1>Exporting</h1>
            <p class="doc-subtitle">Export your rebuttal letters as Word documents, JSON data, or formatted reports.</p>

            <h2>Export Formats</h2>
            <p>Rebuttr supports multiple export formats to fit your workflow:</p>

            <h3>Word Document (.docx)</h3>
            <p>Professional, formatted documents ready for journal submission. Includes proper headings, formatting, and track changes support.</p>

            <h3>JSON (.json)</h3>
            <p>Structured data export for programmatic workflows, backups, or integration with other tools.</p>

            <h3>Markdown (.md)</h3>
            <p>Plain text with formatting. Ideal for version control, collaboration, or conversion to other formats.</p>

            <h3>PDF (.pdf)</h3>
            <p>Fixed-format document for final submissions or archiving. Generated from the Word template.</p>

            <h2>Exporting via Web Interface</h2>
            <ol>
                <li>Navigate to your paper</li>
                <li>Click the <strong>"Export"</strong> button in the toolbar</li>
                <li>Select your desired format</li>
                <li>Configure export options (see below)</li>
                <li>Click <strong>"Download"</strong></li>
            </ol>

            <h2>Export Options</h2>

            <h3>Content Options</h3>
            <table class="doc-table">
                <tr>
                    <th>Option</th>
                    <th>Description</th>
                    <th>Default</th>
                </tr>
                <tr>
                    <td>Include all reviewers</td>
                    <td>Export comments from all reviewers</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Include editor comments</td>
                    <td>Include editor/AE comments in export</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Include unanswered</td>
                    <td>Include comments without responses</td>
                    <td>No</td>
                </tr>
                <tr>
                    <td>Group by reviewer</td>
                    <td>Organize by reviewer vs. by category</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Include line references</td>
                    <td>Show manuscript line references</td>
                    <td>Yes</td>
                </tr>
            </table>

            <h3>Formatting Options</h3>
            <table class="doc-table">
                <tr>
                    <th>Option</th>
                    <th>Description</th>
                    <th>Default</th>
                </tr>
                <tr>
                    <td>Comment style</td>
                    <td>Italic, bold, or quoted</td>
                    <td>Italic</td>
                </tr>
                <tr>
                    <td>Response style</td>
                    <td>Normal, indented, or boxed</td>
                    <td>Normal</td>
                </tr>
                <tr>
                    <td>Numbering</td>
                    <td>Auto-number comments</td>
                    <td>Yes</td>
                </tr>
                <tr>
                    <td>Include header</td>
                    <td>Add paper title and metadata</td>
                    <td>Yes</td>
                </tr>
            </table>

            <h2>Exporting via CLI</h2>
            <p>Export papers programmatically using the command line:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="comment"># Export as Word document</span>
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" --format docx --output rebuttal.docx</span>

<span class="comment"># Export as JSON</span>
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" --format json --output data.json</span>

<span class="comment"># Export as Markdown</span>
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" --format md --output rebuttal.md</span>

<span class="comment"># Export specific reviewer only</span>
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" --reviewer 1 --output reviewer1.docx</span>

<span class="comment"># Export with custom options</span>
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" \</span>
<span class="command">  --format docx \</span>
<span class="command">  --group-by category \</span>
<span class="command">  --include-unanswered \</span>
<span class="command">  --output full-rebuttal.docx</span>
                </div>
            </div>

            <h2>Word Document Structure</h2>
            <p>Exported Word documents follow a professional structure:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Document Structure</span>
                </div>
                <div class="code-content">
RESPONSE TO REVIEWERS

Paper: [Your Paper Title]
Journal: [Target Journal]
Date: [Export Date]

────────────────────────────────

REVIEWER 1

Comment 1.1 (Major):
[Reviewer's comment in italics]

Response:
We thank the reviewer for... [Your response]

Comment 1.2 (Minor):
[Reviewer's comment in italics]

Response:
[Your response]

────────────────────────────────

REVIEWER 2
...
                </div>
            </div>

            <h2>JSON Export Structure</h2>
            <p>JSON exports include complete data for backup or integration:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>export.json</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
{
  "paper": {
    "id": "paper-123",
    "title": "My Research Paper",
    "journal": "Nature",
    "authors": ["Author One", "Author Two"],
    "createdAt": "2024-01-15T10:30:00Z"
  },
  "reviews": [
    {
      "reviewer": "Reviewer 1",
      "comments": [
        {
          "id": "comment-1",
          "text": "The methodology...",
          "category": "major",
          "response": "We thank the reviewer...",
          "status": "completed",
          "lineReference": "Lines 45-67"
        }
      ]
    }
  ],
  "exportedAt": "2024-02-01T14:00:00Z"
}
                </div>
            </div>

            <p>See <a href="json-format.html">JSON Format Reference</a> for complete schema documentation.</p>

            <h2>Batch Export</h2>
            <p>Export multiple papers at once:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="comment"># Export all papers</span>
<span class="prompt">$</span> <span class="command">rebuttr export --all --format json --output-dir ./exports/</span>

<span class="comment"># Export completed papers only</span>
<span class="prompt">$</span> <span class="command">rebuttr export --all --completed --format docx --output-dir ./rebuttals/</span>
                </div>
            </div>

            <h2>Custom Templates</h2>
            <p>Create custom Word templates for journal-specific formatting:</p>

            <ol>
                <li>Create a <code>.docx</code> template with your desired styles</li>
                <li>Place it in <code>~/.config/rebuttr/templates/</code></li>
                <li>Reference it during export:</li>
            </ol>

            <div class="code-block">
                <div class="code-header">
                    <span>Terminal</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="prompt">$</span> <span class="command">rebuttr export --paper "My Paper" --template nature.docx --output rebuttal.docx</span>
                </div>
            </div>

            <div class="alert alert-info">
                <h5>Template Styles</h5>
                <p>Templates use named styles: "Comment" for reviewer text, "Response" for your replies, and standard heading styles for structure.</p>
            </div>

            <h2>Best Practices</h2>
            <ul>
                <li>Export to JSON regularly as a backup</li>
                <li>Use Word format for final submission to journals</li>
                <li>Keep Markdown exports in version control</li>
                <li>Test custom templates before important deadlines</li>
                <li>Review the exported document for formatting issues</li>
            </ul>

            <div class="alert alert-success">
                <h5>Pro Tip</h5>
                <p>Many journals accept Markdown or can convert from Word. Check your target journal's submission guidelines for preferred formats.</p>
            </div>

            <div class="alert alert-warning">
                <h5>Warning</h5>
                <p>Always verify exported documents before submission. Review formatting, numbering, and ensure all responses are included.</p>
            </div>

            <h2>Next Steps</h2>
            <ul>
                <li><a href="json-format.html">JSON format</a> - Complete schema reference</li>
                <li><a href="cli-reference.html">CLI reference</a> - All command options</li>
                <li><a href="multi-paper.html">Multi-paper</a> - Manage multiple submissions</li>
            </ul>
        </main>
    </div>

    <footer class="doc-footer">
        <p>
            <a href="index.html">Documentation</a> |
            <a href="https://github.com/genomewalker/rebuttr">GitHub</a> |
            <a href="troubleshooting.html">Troubleshooting</a>
        </p>
    </footer>

    <script>
        // Nav scroll effect
        const nav = document.getElementById('nav');
        window.addEventListener('scroll', () => {
            nav.classList.toggle('scrolled', window.scrollY > 50);
        });

        // Copy code functionality
        function copyCode(btn) {
            const code = btn.closest('.code-block').querySelector('.code-content').textContent;
            navigator.clipboard.writeText(code.trim());
            btn.textContent = 'Copied!';
            setTimeout(() => btn.textContent = 'Copy', 2000);
        }
    </script>
</body>
</html>
