<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troubleshooting - Rebuttr Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/docs.css">
</head>
<body>
    <nav class="doc-nav" id="nav">
        <div class="nav-container">
            <a href="../index.html" class="logo">
                <span class="logo-mark">RF</span>
                <span class="logo-text">Rebuttr</span>
            </a>
            <ul class="nav-links">
                <li><a href="../index.html">Home</a></li>
                <li><a href="../tutorial.html">Tutorial</a></li>
                <li><a href="https://github.com/genomewalker/rebuttr">GitHub</a></li>
            </ul>
        </div>
    </nav>

    <div class="doc-layout">
        <aside class="doc-sidebar">
            <h4>Getting started</h4>
            <a href="installation.html">Installation</a>
            <a href="quickstart.html">Quick start</a>
            <a href="../tutorial.html">Tutorial</a>

            <h4>User guide</h4>
            <a href="importing.html">Importing reviews</a>
            <a href="ai-features.html">AI features</a>
            <a href="exporting.html">Exporting</a>
            <a href="multi-paper.html">Multi-paper</a>

            <h4>Configuration</h4>
            <a href="configuration.html">Configuration</a>
            <a href="cli-reference.html">CLI reference</a>
            <a href="skills.html">AI skills</a>

            <h4>Reference</h4>
            <a href="../api/">API reference</a>
            <a href="json-format.html">JSON format</a>
            <a href="troubleshooting.html" class="active">Troubleshooting</a>
        </aside>

        <main class="doc-content">
            <h1>Troubleshooting</h1>
            <p class="doc-subtitle">Solutions to common issues when using Rebuttr.</p>

            <h2>Installation Issues</h2>

            <h3>SQLite compilation errors on install</h3>
            <p><strong>Cause:</strong> Missing build tools required for native module compilation.</p>
            <p><strong>Solution:</strong> Install platform-specific build tools:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>macOS</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content"><span class="prompt">$</span> <span class="command">xcode-select --install</span></div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Ubuntu/Debian</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content"><span class="prompt">$</span> <span class="command">sudo apt-get install build-essential python3</span></div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Windows (PowerShell Admin)</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content"><span class="prompt">></span> <span class="command">npm install -g windows-build-tools</span></div>
            </div>

            <h3>Permission denied errors</h3>
            <p><strong>Cause:</strong> npm global packages require elevated permissions.</p>
            <p><strong>Solution:</strong> Fix npm permissions or use a node version manager:</p>

            <div class="code-block">
                <div class="code-header">
                    <span>Option 1: Fix npm permissions</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="prompt">$</span> <span class="command">mkdir ~/.npm-global</span>
<span class="prompt">$</span> <span class="command">npm config set prefix '~/.npm-global'</span>
<span class="comment"># Add to ~/.bashrc or ~/.zshrc:</span>
<span class="command">export PATH=~/.npm-global/bin:$PATH</span>
                </div>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Option 2: Use nvm</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="prompt">$</span> <span class="command">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash</span>
<span class="prompt">$</span> <span class="command">nvm install 20</span>
<span class="prompt">$</span> <span class="command">nvm use 20</span>
                </div>
            </div>

            <h2>Runtime Issues</h2>

            <h3>Port 3001 already in use</h3>
            <p><strong>Cause:</strong> Another process is using port 3001, or a previous Rebuttr instance didn't shut down properly.</p>
            <p><strong>Solution:</strong></p>

            <div class="code-block">
                <div class="code-header">
                    <span>Find and kill the process</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="comment"># Find process using port 3001</span>
<span class="prompt">$</span> <span class="command">lsof -i :3001</span>

<span class="comment"># Kill the process</span>
<span class="prompt">$</span> <span class="command">kill -9 &lt;PID&gt;</span>

<span class="comment"># Or use a different port</span>
<span class="prompt">$</span> <span class="command">REBUTTR_PORT=3002 rebuttr</span>
                </div>
            </div>

            <h3>Browser doesn't open automatically</h3>
            <p><strong>Cause:</strong> The <code>open</code> command isn't available or the browser can't be detected.</p>
            <p><strong>Solution:</strong> Manually navigate to <code>http://localhost:3001</code> in your browser.</p>

            <h3>Changes not saved between sessions</h3>
            <p><strong>Cause:</strong> Database connection issue or file permissions problem.</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Check that the data directory exists and is writable:
                    <div class="code-block">
                        <div class="code-header"><span>Terminal</span></div>
                        <div class="code-content"><span class="prompt">$</span> <span class="command">ls -la ~/Rebuttr/data/</span></div>
                    </div>
                </li>
                <li>Check the server logs for database errors:
                    <div class="code-block">
                        <div class="code-header"><span>Terminal</span></div>
                        <div class="code-content"><span class="prompt">$</span> <span class="command">cat /tmp/server.log</span></div>
                    </div>
                </li>
                <li>Try resetting the database (backup first!):
                    <div class="code-block">
                        <div class="code-header"><span>Terminal</span></div>
                        <div class="code-content"><span class="prompt">$</span> <span class="command">rm ~/Rebuttr/data/review_platform.db</span></div>
                    </div>
                </li>
            </ol>

            <div class="alert alert-warning">
                <h5>Warning</h5>
                <p>Deleting the database file will remove all your saved papers and responses. Export your data first!</p>
            </div>

            <h2>AI features Issues</h2>

            <h3>"OpenCode not ready" error</h3>
            <p><strong>Cause:</strong> OpenCode CLI isn't installed or configured properly.</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Install OpenCode: <code>npm i -g opencode-ai</code></li>
                <li>Configure API key: Run <code>opencode</code> and follow the setup prompts</li>
                <li>Restart Rebuttr</li>
            </ol>

            <h3>Expert discussions not generating</h3>
            <p><strong>Cause:</strong> AI skills not installed or context not loaded.</p>
            <p><strong>Solution:</strong></p>
            <ol>
                <li>Verify skills are installed:
                    <div class="code-block">
                        <div class="code-header"><span>Terminal</span></div>
                        <div class="code-content"><span class="prompt">$</span> <span class="command">ls ~/.config/opencode/skill/</span></div>
                    </div>
                </li>
                <li>Reinstall skills:
                    <div class="code-block">
                        <div class="code-header"><span>Terminal</span></div>
                        <div class="code-content"><span class="prompt">$</span> <span class="command">npm i -g github:genomewalker/rebuttr</span></div>
                    </div>
                </li>
                <li>Click "Update Context" in the AI Knowledge panel</li>
            </ol>

            <h3>"No draft responses found" when exporting</h3>
            <p><strong>Cause:</strong> Comments don't have responses saved yet.</p>
            <p><strong>Solution:</strong> You need to either:</p>
            <ul>
                <li>Write manual responses in the Response Builder</li>
                <li>Generate expert discussions and use their recommended responses</li>
                <li>Mark at least some comments as "Completed"</li>
            </ul>

            <h2>File Processing Issues</h2>

            <h3>PDF not parsing correctly</h3>
            <p><strong>Cause:</strong> PDF has complex formatting, images, or is a scanned document.</p>
            <p><strong>Solution:</strong></p>
            <ul>
                <li>Try exporting the PDF as text first</li>
                <li>Use a DOCX file instead if available</li>
                <li>Copy/paste the text directly into Rebuttr</li>
            </ul>

            <h2>Getting Help</h2>

            <div class="alert alert-info">
                <h5>Need More Help?</h5>
                <p>If you can't find a solution here, try the resources below.</p>
            </div>

            <ul>
                <li><strong>GitHub Issues:</strong> <a href="https://github.com/genomewalker/rebuttr/issues">Report a bug</a></li>
                <li><strong>Debug logs:</strong> Run with <code>DEBUG=rebuttr:* rebuttr</code></li>
                <li><strong>Server logs:</strong> Check <code>/tmp/server.log</code></li>
            </ul>

            <h2>Reset Everything</h2>
            <p>If all else fails, you can completely reset Rebuttr:</p>

            <div class="alert alert-warning">
                <h5>Warning</h5>
                <p>This will delete all your data. Make sure to export and backup your papers first!</p>
            </div>

            <div class="code-block">
                <div class="code-header">
                    <span>Complete Reset (backup data first!)</span>
                    <button class="copy-btn" onclick="copyCode(this)">Copy</button>
                </div>
                <div class="code-content">
<span class="comment"># Uninstall</span>
<span class="prompt">$</span> <span class="command">npm uninstall -g rebuttr</span>

<span class="comment"># Remove data (BACKUP FIRST!)</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/Rebuttr</span>

<span class="comment"># Remove skills</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/reviewer</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/dna_auth</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/ecology</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/evolution</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/virome</span>
<span class="prompt">$</span> <span class="command">rm -rf ~/.config/opencode/skill/methods</span>

<span class="comment"># Reinstall</span>
<span class="prompt">$</span> <span class="command">npm i -g github:genomewalker/rebuttr</span>
                </div>
            </div>

            <div class="alert alert-success">
                <h5>Still Having Issues?</h5>
                <p>Open an issue on <a href="https://github.com/genomewalker/rebuttr/issues">GitHub</a> with details about your system and the error messages you're seeing.</p>
            </div>
        </main>
    </div>

    <footer class="doc-footer">
        <p>
            <a href="../index.html">Documentation</a> |
            <a href="https://github.com/genomewalker/rebuttr">GitHub</a> |
            <a href="installation.html">Installation</a>
        </p>
    </footer>

    <script>
        // Nav scroll effect
        const nav = document.getElementById('nav');
        window.addEventListener('scroll', () => {
            nav.classList.toggle('scrolled', window.scrollY > 50);
        });

        // Copy code functionality
        function copyCode(btn) {
            const code = btn.closest('.code-block').querySelector('.code-content').textContent;
            navigator.clipboard.writeText(code.trim());
            btn.textContent = 'Copied!';
            setTimeout(() => btn.textContent = 'Copy', 2000);
        }
    </script>
</body>
</html>
